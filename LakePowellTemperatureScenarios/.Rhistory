direct.label(pPlot, "angled.boxes" )
pPlot <- ggplot(dfPowellReleaseTempSum, aes(rangeDay, group=Month, color=MonthTxt)) +
stat_ecdf(geom = "step") +
#scale_x_continuous(limits = c(2,22), breaks = seq(2,22,by=2)) +
#scale_y_continuous(breaks = seq(0,11,by=2)) +
scale_color_manual(values = palBlueFunc(12)) +
xlim(0,2) +
facet_wrap( ~ Year ) +
labs(x="Daily Range of Powell Release Temperature (oC)", y="Cumulative Frequency\n(number of days)", color = "Month") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
direct.label(pPlot, "angled.boxes" )
pPlot <- ggplot(dfPowellReleaseTempSum, aes(rangeDay, group=Month, color=MonthTxt)) +
stat_ecdf(geom = "step") +
#scale_x_continuous(limits = c(2,22), breaks = seq(2,22,by=2)) +
#scale_y_continuous(breaks = seq(0,11,by=2)) +
scale_color_manual(values = palBlueFunc(12)) +
xlim(0,2) +
#facet_wrap( ~ Year ) +
labs(x="Daily Range of Powell Release Temperature (oC)", y="Cumulative Frequency\n(number of days)", color = "Month") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
direct.label(pPlot, "angled.boxes" )
pPlot <- ggplot(dfPowellReleaseTempSum, aes(rangeDay, group=Year, color=Year)) +
stat_ecdf(geom = "step") +
#scale_x_continuous(limits = c(2,22), breaks = seq(2,22,by=2)) +
#scale_y_continuous(breaks = seq(0,11,by=2)) +
scale_color_manual(values = palBlueFunc(12)) +
xlim(0,2) +
#facet_wrap( ~ Year ) +
labs(x="Daily Range of Powell Release Temperature (oC)", y="Cumulative Frequency\n(number of days)", color = "Month") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
direct.label(pPlot, "angled.boxes" )
pPlot <- ggplot(dfPowellReleaseTempSum, aes(rangeDay, group=Year, color=Year)) +
stat_ecdf(geom = "step") +
#scale_x_continuous(limits = c(2,22), breaks = seq(2,22,by=2)) +
#scale_y_continuous(breaks = seq(0,11,by=2)) +
#scale_color_manual(values = palBlueFunc(12)) +
xlim(0,2) +
#facet_wrap( ~ Year ) +
labs(x="Daily Range of Powell Release Temperature (oC)", y="Cumulative Frequency\n(number of days)", color = "Month") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
direct.label(pPlot, "angled.boxes" )
ggsave("PowellReleaseTempRangeByYearCDF.png", width=9, height = 6.5, units="in")
pPlot <- ggplot(dfPowellReleaseTempSum %>% filter(Year > 1988), aes(rangeDay, group=Year, color=Year)) +
stat_ecdf(geom = "step") +
#scale_x_continuous(limits = c(2,22), breaks = seq(2,22,by=2)) +
#scale_y_continuous(breaks = seq(0,11,by=2)) +
#scale_color_manual(values = palBlueFunc(12)) +
xlim(0,2) +
#facet_wrap( ~ Year ) +
labs(x="Daily Range of Powell Release Temperature (oC)", y="Cumulative Frequency\n(number of days)", color = "Month") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
direct.label(pPlot, "angled.boxes" )
dfDaysPerYear <- dfPowellReleaseTempSum %>% group_by(Year) %>% summarize(numDays = n())
View(dfDaysPerYear)
dfDaysPerMonthYear <- dfPowellReleaseTempSum %>% group_by(Year,Month) %>% summarize(numDays = n())
View(dfDaysPerMonthYear)
pPlot <- ggplot(dfPowellReleaseTempSum %>% filter(Year > 1988), aes(rangeDay, group=Year, color=Year)) +
stat_ecdf(geom = "step") +
#scale_x_continuous(limits = c(2,22), breaks = seq(2,22,by=2)) +
#scale_y_continuous(breaks = seq(0,11,by=2)) +
#scale_color_manual(values = palBlueFunc(12)) +
xlim(0,2) +
facet_wrap( ~ Month ) +
labs(x="Daily Range of Powell Release Temperature (oC)", y="Cumulative Frequency\n(number of days)", color = "Month") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
direct.label(pPlot, "angled.boxes" )
ggplot(dfPowellReleaseTempSum %>% filter(Year > 1988), aes(rangeDay, group=Year, color=Year)) +
stat_ecdf(geom = "step") +
#scale_x_continuous(limits = c(2,22), breaks = seq(2,22,by=2)) +
#scale_y_continuous(breaks = seq(0,11,by=2)) +
#scale_color_manual(values = palBlueFunc(12)) +
xlim(0,2) +
facet_wrap( ~ Month ) +
labs(x="Daily Range of Powell Release Temperature (oC)", y="Cumulative Frequency\n(number of days)", color = "Month") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
pPlot <- ggplot(dfPowellReleaseTempSum %>% filter(Year > 1988), aes(rangeDay, group=Year, color=Year)) +
stat_ecdf(geom = "step") +
#scale_x_continuous(limits = c(2,22), breaks = seq(2,22,by=2)) +
#scale_y_continuous(breaks = seq(0,11,by=2)) +
#scale_color_manual(values = palBlueFunc(12)) +
xlim(0,2) +
#facet_wrap( ~ Month ) +
labs(x="Daily Range of Powell Release Temperature (oC)", y="Cumulative Frequency\n(number of days)", color = "Month") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
direct.label(pPlot, "angled.boxes" )
ggsave("PowellReleaseTempRangeByYearCDF.png", width=9, height = 6.5, units="in")
ggplot(dfPowellReleaseTempSum %>% filter(Year > 1988), aes(rangeDay, group=Year, color=Year)) +
stat_ecdf(geom = "step") +
#scale_x_continuous(limits = c(2,22), breaks = seq(2,22,by=2)) +
#scale_y_continuous(breaks = seq(0,11,by=2)) +
#scale_color_manual(values = palBlueFunc(12)) +
xlim(0,2) +
facet_wrap( ~ Month ) +
labs(x="Daily Range of Powell Release Temperature (oC)", y="Cumulative Frequency\n(number of days)", color = "Month") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
ggplot(dfPowellReleaseTempSum %>% filter(Year > 1988), aes(rangeDay, group=Year, color=Year)) +
stat_ecdf(geom = "step") +
xlim(0,2) +
facet_wrap( ~ Month ) +
scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color") +
labs(x="Daily Range of Powell Release Temperature (oC)", y="Cumulative Frequency\n(number of days)", color = "Year") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
ggplot(dfPowellReleaseTempSum %>% filter(Year > 1988), aes(rangeDay, group=Year, color=Year)) +
stat_ecdf(geom = "step") +
xlim(0,2) +
facet_wrap( ~ Month ) +
scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color", name="Year") +
labs(x="Daily Range of Powell Release Temperature (oC)", y="Cumulative Frequency\n(number of days)", color = "Year") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
dfPowellReleaseTempSum$WaterYear <- ifelse(dfPowellReleaseTempSum$Month >= 10,dfPowellReleaseTempSum$Year, dfPowellReleaseTempSum$Year - 1 )
pPlot <- ggplot(dfPowellReleaseTempSum %>% filter(Year > 1988), aes(rangeDay, group=WaterYear, color=WaterYear)) +
stat_ecdf(geom = "step") +
#scale_x_continuous(limits = c(2,22), breaks = seq(2,22,by=2)) +
#scale_y_continuous(breaks = seq(0,11,by=2)) +
#scale_color_manual(values = palBlueFunc(12)) +
xlim(0,2) +
#facet_wrap( ~ Month ) +
labs(x="Daily Range of Powell Release Temperature (oC)", y="Cumulative Frequency\n(number of days)", color = "Month") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
direct.label(pPlot, "angled.boxes" )
pPlot <- ggplot(dfPowellReleaseTempSum %>% filter(WaterYear < 2018), aes(rangeDay, group=WaterYear, color=WaterYear)) +
stat_ecdf(geom = "step") +
#scale_x_continuous(limits = c(2,22), breaks = seq(2,22,by=2)) +
#scale_y_continuous(breaks = seq(0,11,by=2)) +
#scale_color_manual(values = palBlueFunc(12)) +
xlim(0,2) +
#facet_wrap( ~ Month ) +
labs(x="Daily Range of Powell Release Temperature (oC)", y="Cumulative Frequency\n(number of days)", color = "Month") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
direct.label(pPlot, "angled.boxes" )
pPlot <- ggplot(dfPowellReleaseTempSum %>% filter(WaterYear < 2018), aes(rangeDay, group=WaterYear, color=WaterYear)) +
stat_ecdf(geom = "step") +
#scale_x_continuous(limits = c(2,22), breaks = seq(2,22,by=2)) +
#scale_y_continuous(breaks = seq(0,11,by=2)) +
scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color", name="Water Year") +
xlim(0,2) +
#facet_wrap( ~ Month ) +
labs(x="Daily Range of Powell Release Temperature (oC)", y="Cumulative Frequency\n(number of days)", color = "Water Year") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
direct.label(pPlot, "angled.boxes" )
ggsave("PowellReleaseTempRangeByYearCDF.png", width=9, height = 6.5, units="in")
ggplot(dfPowellReleaseTempSum %>% filter(Year > 1988), aes(rangeDay, group=WaterYear, color=WaterYear)) +
stat_ecdf(geom = "step") +
xlim(0,2) +
facet_wrap( ~ Month ) +
scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color", name="Year") +
labs(x="Daily Range of Powell Release Temperature (oC)", y="Cumulative Frequency\n(number of days)", color = "Year") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
ggsave("PowellReleaseTempRangeByMonthYearCDF.png", width=9, height = 6.5, units="in")
ggplot(dfPowellReleaseTempSum %>% filter(Year > 2006)) +
geom_line(aes(x=Day,y=avgDay), color="black") +
#Error bar
geom_errorbar(aes(x=Day,ymin= minDay, ymax=maxDay), color="black") +
scale_x_continuous(breaks = c(1,31)) +
scale_y_continuous(breaks = c(8,16)) +
facet_grid(Year ~ Month) +
labs(x="Day", y="Release Temperature (oC)") +
theme(text = element_text(size=12), legend.title=element_blank(), legend.text=element_text(size=10),
legend.key = element_blank())
ggplot(data=dfPowellTemp) +
#Release Temperature
geom_line(aes(x = DateTimeClean,y = WaterTemp_C, color = "Release"), size=1) +
geom_point(aes(x = DateTimeClean, y = Wahweap, color = "Wahweap @ 3,490 feet"), size=1.5) +
scale_color_manual(values=c("Black","Red")) +
#scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color") +
scale_x_datetime() +
theme_bw() +
#coord_fixed() +
labs(y="Water Temperature (oC)", x="", color="") +
theme(text = element_text(size=18), legend.text=element_text(size=16), legend.position = c(0.2, 0.9))
ggplot(data=dfPowellReleaseElev) +
#Release Temperature
#Error bar on release data - color by water surface
geom_errorbar(aes(x = as.POSIXct(DateClean), ymin= minDay, ymax=maxDay, color="Release Temperature"), size=1) +
geom_line(aes(x = as.POSIXct(DateClean),y = 8 + 8*(WaterSurface - 3500)/(3700-3500), color = "Water Surface"), size=1) +
#geom_point(aes(x = DateTimeClean, y = Wahweap), size=1.5) +
scale_color_manual(values=c("Black","Red")) +
#scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color") +
scale_x_datetime() +
scale_y_continuous(sec.axis = sec_axis(~ (. - 8)/8*(3700-3500) + 3500, name = "Water Surface (feet)")) +
theme_bw() +
#coord_fixed() +
labs(y="Water Temperature (oC)", x="", color="") +
theme(text = element_text(size=18), legend.text=element_text(size=16), legend.position = c(0.2, 0.9))
ggplot(data=dfPowellReleaseElev) +
#Release Temperature
#Error bar on release data - color by water surface
geom_errorbar(aes(x = as.POSIXct(DateClean), ymin= minDay, ymax=maxDay, color=WaterSurface), size=1) +
#geom_line(aes(x = as.POSIXct(DateClean),y = 8 + 8*(WaterSurface - 3500)/(3700-3500), color = "Water Surface"), size=1) +
#geom_point(aes(x = DateTimeClean, y = Wahweap), size=1.5) +
#scale_color_manual(values=c("Black","Red")) +
scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color") +
scale_x_datetime() +
#scale_y_continuous(sec.axis = sec_axis(~ (. - 8)/8*(3700-3500) + 3500, name = "Water Surface (feet)")) +
theme_bw() +
#coord_fixed() +
labs(y="Water Temperature (oC)", x="", color="Water Surface (feet)") +
theme(text = element_text(size=18), legend.text=element_text(size=16), legend.position = c(0.2, 0.9))
ggplot(data=dfPowellReleaseElev %>% filter(Day %in% seq(1,31, by=1)) %>% arrange(DateClean)) +
#geom_line(aes(x=Day,y=avgDay), color="black") +
#Error bar on release data - color by water surface
geom_errorbar(aes(x=WaterSurface, ymin= minDay, ymax=maxDay, color = Month.x), size=1) +
scale_color_continuous(low=palBlues[2],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color") +
labs(x="Water Surface Elevation (feet)", y="Release Temperature (oC)", color="Month") +
#labs(x="Temperature at Wahweap @ 3,490 ft (oC)", y="Release Temperature (oC)", color="") +
theme(text = element_text(size=18), legend.text=element_text(size=16),
legend.key = element_blank())
ggplot(data=dfPowellReleaseElev %>% filter(Day %in% seq(1,31, by=2), !is.na(LevelYearType), !is.na(TempYearType)) %>% arrange(DateClean) , aes(x=WaterSurface,y=avgDay),color=LevelYearType) +
#geom_line(aes(x=Day,y=avgDay), color="black") +
#Error bar on release data - color by water surface
geom_errorbar(aes(ymin= minDay, ymax=maxDay, color=WaterYear), size=1) +
#geom_path(color="red") +
#geom_point(aes(x=WaterLevel, y=avgDay, color=Month.x), size=1) +
# Label January 1 of each year
#geom_text(data=dfPowellReleaseElev %>% filter(Month.x==10,Day==1, !is.na(LevelYearType), !is.na(TempYearType)), aes(x=WaterSurface,y=avgDay,label=WaterYear),color="Purple", size=4) +
geom_text_repel(data=dfPowellReleaseElev %>% filter(Month.x==10,Day==1, !is.na(LevelYearType), !is.na(TempYearType)), aes(x=WaterSurface,y=avgDay,label=WaterYear),color="Purple", size=4) +
geom_point(data=dfPowellReleaseElev %>% filter(Month.x==10,Day==1, !is.na(LevelYearType), !is.na(TempYearType)), aes(x=WaterSurface,y=avgDay),color="purple") +
#1:1 line
#geom_abline(intercept = 0, slope = 1, color="red", linetype = "longdash", size = 1.5) +
#coord_fixed(ratio=1) +
#scale_x_discrete(breaks = c(3370, seq(3400,3720, by=50))) +
scale_y_continuous(sec.axis = sec_axis(~. +0 ,name="Temperature Change", breaks=c(0), labels = c(""))) +
scale_x_continuous(sec.axis = sec_axis(~. +0 ,name="Water Level Change", breaks=c(0), labels = c(""))) +
#facet_grid(Month ~ Year) +
scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color") +
#scale_color_manual(values = c("Red","Blue","grey75", "grey50")) +
labs(x="Water Surface Elevation (feet)", y="Release Temperature (oC)", color="Water Level Change\nfor Year") +
#labs(x="Temperature at Wahweap @ 3,490 ft (oC)", y="Release Temperature (oC)", color="") +
facet_grid( TempYearType ~ LevelYearType) +
theme(text = element_text(size=18), legend.text=element_text(size=16),
legend.key = element_blank())
View(dfPowellReleaseElev)
ggplot(data=dfPowellReleaseElev %>% filter(Day %in% seq(1,31, by=1)) %>% arrange(DateClean)) +
#geom_line(aes(x=Day,y=avgDay), color="black") +
#Error bar on release data - color by water surface
geom_errorbar(aes(x=WaterSurface, ymin= minDay, ymax=maxDay, color = Month.x), size=1) +
scale_color_continuous(low=palBlues[2],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color") +
labs(x="Water Surface Elevation (feet)", y="Release Temperature (oC)", color="Month") +
#labs(x="Temperature at Wahweap @ 3,490 ft (oC)", y="Release Temperature (oC)", color="") +
theme(text = element_text(size=18), legend.text=element_text(size=16),
legend.key = element_blank())
ggplot(data=dfPowellReleaseElev) +
#Release Temperature
#Error bar on release data - color by water surface
geom_errorbar(aes(x = as.POSIXct(DateClean), ymin= minDay, ymax=maxDay, color=WaterSurface), size=1) +
#geom_line(aes(x = as.POSIXct(DateClean),y = 8 + 8*(WaterSurface - 3500)/(3700-3500), color = "Water Surface"), size=1) +
#geom_point(aes(x = DateTimeClean, y = Wahweap), size=1.5) +
#scale_color_manual(values=c("Black","Red")) +
scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color") +
scale_x_datetime() +
#scale_y_continuous(sec.axis = sec_axis(~ (. - 8)/8*(3700-3500) + 3500, name = "Water Surface (feet)")) +
theme_bw() +
#coord_fixed() +
labs(y="Water Temperature (oC)", x="", color="Water Surface (feet)") +
theme(text = element_text(size=18), legend.text=element_text(size=16), legend.position = c(0.2, 0.9))
ggplot(data=dfPowellReleaseElev) +
#Release Temperature
#Error bar on release data - color by water surface
geom_errorbar(aes(x = as.POSIXct(DateClean), ymin= minDay, ymax=maxDay, color=as.factor(Month)), size=1) +
#geom_line(aes(x = as.POSIXct(DateClean),y = 8 + 8*(WaterSurface - 3500)/(3700-3500), color = "Water Surface"), size=1) +
#geom_point(aes(x = DateTimeClean, y = Wahweap), size=1.5) +
scale_color_manual(values=c(rep(palBlues[9]),5),rep("Red",5),rep(palBlues[9],2)) +
#scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color") +
scale_x_datetime() +
#scale_y_continuous(sec.axis = sec_axis(~ (. - 8)/8*(3700-3500) + 3500, name = "Water Surface (feet)")) +
theme_bw() +
#coord_fixed() +
labs(y="Water Temperature (oC)", x="", color="Month") +
theme(text = element_text(size=18), legend.text=element_text(size=16), legend.position = c(0.2, 0.9))
ggplot(data=dfPowellReleaseElev) +
#Release Temperature
#Error bar on release data - color by water surface
geom_errorbar(aes(x = as.POSIXct(DateClean), ymin= minDay, ymax=maxDay, color=as.factor(Month.x)), size=1) +
#geom_line(aes(x = as.POSIXct(DateClean),y = 8 + 8*(WaterSurface - 3500)/(3700-3500), color = "Water Surface"), size=1) +
#geom_point(aes(x = DateTimeClean, y = Wahweap), size=1.5) +
scale_color_manual(values=c(rep(palBlues[9]),5),rep("Red",5),rep(palBlues[9],2)) +
#scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color") +
scale_x_datetime() +
#scale_y_continuous(sec.axis = sec_axis(~ (. - 8)/8*(3700-3500) + 3500, name = "Water Surface (feet)")) +
theme_bw() +
#coord_fixed() +
labs(y="Water Temperature (oC)", x="", color="Month") +
theme(text = element_text(size=18), legend.text=element_text(size=16), legend.position = c(0.2, 0.9))
g
ggplot(data=dfPowellReleaseElev) +
#Release Temperature
#Error bar on release data - color by water surface
geom_errorbar(aes(x = as.POSIXct(DateClean), ymin= minDay, ymax=maxDay, color=as.factor(Month.x)), size=1) +
#geom_line(aes(x = as.POSIXct(DateClean),y = 8 + 8*(WaterSurface - 3500)/(3700-3500), color = "Water Surface"), size=1) +
#geom_point(aes(x = DateTimeClean, y = Wahweap), size=1.5) +
scale_color_manual(values=c(rep(palBlues[9]),5),rep("Red",5),rep(palBlues[9],2)) +
#scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color") +
scale_x_datetime() +
#scale_y_continuous(sec.axis = sec_axis(~ (. - 8)/8*(3700-3500) + 3500, name = "Water Surface (feet)")) +
theme_bw() +
#coord_fixed() +
labs(y="Water Temperature (oC)", x="", color="Month") +
theme(text = element_text(size=18), legend.text=element_text(size=16), legend.position = c(0.2, 0.9))
c(rep(palBlues[9]),5),rep("Red",5),rep(palBlues[9],2))
c(rep(palBlues[9]),5), rep("Red",5), rep(palBlues[9],2))
c(rep(palBlues[9],5), rep("Red",5), rep(palBlues[9],2))
ggplot(data=dfPowellReleaseElev) +
#Release Temperature
#Error bar on release data - color by water surface
geom_errorbar(aes(x = as.POSIXct(DateClean), ymin= minDay, ymax=maxDay, color=as.factor(Month.x)), size=1) +
#geom_line(aes(x = as.POSIXct(DateClean),y = 8 + 8*(WaterSurface - 3500)/(3700-3500), color = "Water Surface"), size=1) +
#geom_point(aes(x = DateTimeClean, y = Wahweap), size=1.5) +
scale_color_manual(values=c(rep(palBlues[9],5), rep("Red",5), rep(palBlues[9],2))) +
#scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color") +
scale_x_datetime() +
#scale_y_continuous(sec.axis = sec_axis(~ (. - 8)/8*(3700-3500) + 3500, name = "Water Surface (feet)")) +
theme_bw() +
#coord_fixed() +
labs(y="Water Temperature (oC)", x="", color="Month") +
theme(text = element_text(size=18), legend.text=element_text(size=16), legend.position = c(0.2, 0.9))
ggplot(data=dfPowellReleaseElev) +
#Release Temperature
#Error bar on release data - color by water surface
geom_errorbar(aes(x = as.POSIXct(DateClean), ymin= minDay, ymax=maxDay, color=as.factor(Month.x)), size=1) +
#geom_line(aes(x = as.POSIXct(DateClean),y = 8 + 8*(WaterSurface - 3500)/(3700-3500), color = "Water Surface"), size=1) +
#geom_point(aes(x = DateTimeClean, y = Wahweap), size=1.5) +
#Color scale - 1:5 blue, 6:10 red, 11:12 blue
scale_color_manual(values=c(rep(palBlues[9],4), rep("Red",7), rep(palBlues[9],1))) +
#scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color") +
scale_x_datetime() +
#scale_y_continuous(sec.axis = sec_axis(~ (. - 8)/8*(3700-3500) + 3500, name = "Water Surface (feet)")) +
theme_bw() +
#coord_fixed() +
labs(y="Water Temperature (oC)", x="", color="Month") +
theme(text = element_text(size=18), legend.text=element_text(size=16), legend.position = c(0.2, 0.9))
ggplot(data=dfPowellReleaseElev) +
#Release Temperature
#Error bar on release data - color by water surface
geom_errorbar(aes(x = as.POSIXct(DateClean), ymin= minDay, ymax=maxDay, color=as.factor(Month.x)), size=1) +
#geom_line(aes(x = as.POSIXct(DateClean),y = 8 + 8*(WaterSurface - 3500)/(3700-3500), color = "Water Surface"), size=1) +
#geom_point(aes(x = DateTimeClean, y = Wahweap), size=1.5) +
#Color scale - 1:5 blue, 6:10 red, 11:12 blue
scale_color_manual(values=c(rep(palBlues[9],3), rep("Red",8), rep(palBlues[9],1))) +
#scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color") +
scale_x_datetime() +
#scale_y_continuous(sec.axis = sec_axis(~ (. - 8)/8*(3700-3500) + 3500, name = "Water Surface (feet)")) +
theme_bw() +
#coord_fixed() +
labs(y="Water Temperature (oC)", x="", color="Month") +
theme(text = element_text(size=18), legend.text=element_text(size=16), legend.position = c(0.2, 0.9))
ggplot(data=dfPowellReleaseElev %>% filter(Day %in% seq(1,31, by=2), !is.na(LevelYearType), !is.na(TempYearType)) %>% arrange(DateClean) , aes(x=WaterSurface,y=avgDay),color=LevelYearType) +
#geom_line(aes(x=Day,y=avgDay), color="black") +
#Error bar on release data - color by water surface
#geom_errorbar(aes(ymin= minDay, ymax=maxDay, color=WaterYear), size=1) +
geom_errorbar(aes(ymin= minDay, ymax=maxDay, color=as.factor(Month)), size=1) +
# Label Oct 1 of each year
#geom_text(data=dfPowellReleaseElev %>% filter(Month.x==10,Day==1, !is.na(LevelYearType), !is.na(TempYearType)), aes(x=WaterSurface,y=avgDay,label=WaterYear),color="Purple", size=4) +
geom_text_repel(data=dfPowellReleaseElev %>% filter(Month.x==10,Day==1, !is.na(LevelYearType), !is.na(TempYearType)), aes(x=WaterSurface,y=avgDay,label=WaterYear),color="Purple", size=4) +
geom_point(data=dfPowellReleaseElev %>% filter(Month.x==10,Day==1, !is.na(LevelYearType), !is.na(TempYearType)), aes(x=WaterSurface,y=avgDay),color="purple") +
#1:1 line
#geom_abline(intercept = 0, slope = 1, color="red", linetype = "longdash", size = 1.5) +
#coord_fixed(ratio=1) +
#scale_x_discrete(breaks = c(3370, seq(3400,3720, by=50))) +
scale_y_continuous(sec.axis = sec_axis(~. +0 ,name="Temperature Change", breaks=c(0), labels = c(""))) +
scale_x_continuous(sec.axis = sec_axis(~. +0 ,name="Water Level Change", breaks=c(0), labels = c(""))) +
#facet_grid(Month ~ Year) +
#Color scale - "summer" months in red
scale_color_manual(values=c(rep(palBlues[9],3), rep("Red",8), rep(palBlues[9],1))) +
#scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color") +
#scale_color_manual(values = c("Red","Blue","grey75", "grey50")) +
labs(x="Water Surface Elevation (feet)", y="Release Temperature (oC)", color="Water Level Change\nfor Year") +
#labs(x="Temperature at Wahweap @ 3,490 ft (oC)", y="Release Temperature (oC)", color="") +
facet_grid( TempYearType ~ LevelYearType) +
theme(text = element_text(size=18), legend.text=element_text(size=16),
legend.key = element_blank())
ggplot(data=dfPowellReleaseElev %>% filter(Day %in% seq(1,31, by=2), !is.na(LevelYearType), !is.na(TempYearType)) %>% arrange(DateClean) , aes(x=WaterSurface,y=avgDay),color=LevelYearType) +
#geom_line(aes(x=Day,y=avgDay), color="black") +
#Error bar on release data - color by water surface
#geom_errorbar(aes(ymin= minDay, ymax=maxDay, color=WaterYear), size=1) +
geom_errorbar(aes(ymin= minDay, ymax=maxDay, color=as.factor(Month.x)), size=1) +
# Label Oct 1 of each year
#geom_text(data=dfPowellReleaseElev %>% filter(Month.x==10,Day==1, !is.na(LevelYearType), !is.na(TempYearType)), aes(x=WaterSurface,y=avgDay,label=WaterYear),color="Purple", size=4) +
geom_text_repel(data=dfPowellReleaseElev %>% filter(Month.x==10,Day==1, !is.na(LevelYearType), !is.na(TempYearType)), aes(x=WaterSurface,y=avgDay,label=WaterYear),color="Purple", size=4) +
geom_point(data=dfPowellReleaseElev %>% filter(Month.x==10,Day==1, !is.na(LevelYearType), !is.na(TempYearType)), aes(x=WaterSurface,y=avgDay),color="purple") +
#1:1 line
#geom_abline(intercept = 0, slope = 1, color="red", linetype = "longdash", size = 1.5) +
#coord_fixed(ratio=1) +
#scale_x_discrete(breaks = c(3370, seq(3400,3720, by=50))) +
scale_y_continuous(sec.axis = sec_axis(~. +0 ,name="Temperature Change", breaks=c(0), labels = c(""))) +
scale_x_continuous(sec.axis = sec_axis(~. +0 ,name="Water Level Change", breaks=c(0), labels = c(""))) +
#facet_grid(Month ~ Year) +
#Color scale - "summer" months in red
scale_color_manual(values=c(rep(palBlues[9],3), rep("Red",8), rep(palBlues[9],1))) +
#scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color") +
#scale_color_manual(values = c("Red","Blue","grey75", "grey50")) +
labs(x="Water Surface Elevation (feet)", y="Release Temperature (oC)", color="Water Level Change\nfor Year") +
#labs(x="Temperature at Wahweap @ 3,490 ft (oC)", y="Release Temperature (oC)", color="") +
facet_grid( TempYearType ~ LevelYearType) +
theme(text = element_text(size=18), legend.text=element_text(size=16),
legend.key = element_blank())
dfPowellLevelChange <- rbind(dfPowellReleaseElev %>% filter(Month.x == 1,Day==1),
dfPowellReleaseElev %>% filter(Month.x == 12,Day==31))
dfPowellTempChange <- dcast(dfPowellLevelChange,WaterYear~Month.y , mean, value.var = "avgDay")
dfPowellLevelChange <- dcast(dfPowellLevelChange,WaterYear~Month.y , mean, value.var = c("WaterSurface"))#,"avgDay"))
View(dfPowellLevelChange)
dfPowellLevelChange$LevelYearType <- ifelse(dfPowellLevelChange$Dec - dfPowellLevelChange$Jan > nMargin,"Rise",ifelse(dfPowellLevelChange$Dec - dfPowellLevelChange$Jan < -nMargin,"Fall","Steady"))
dfPowellTempChange$TempYearType <- ifelse(dfPowellTempChange$Dec - dfPowellTempChange$Jan > nTempMargin,"Rise",ifelse(dfPowellTempChange$Dec - dfPowellTempChange$Jan < -nTempMargin,"Fall","Steady"))
View(dfPowellTempChange)
View(dfPowellTempChange)
dfPowellLevelChange <- rbind(dfPowellReleaseElev %>% filter(Month.x == 1,Day==1),
dfPowellReleaseElev %>% filter(Month.x == 12,Day==31))
dfPowellTempChange <- dcast(dfPowellLevelChange,Year~Month.y , mean, value.var = "avgDay")
dfPowellLevelChange <- dcast(dfPowellLevelChange,Year~Month.y , mean, value.var = c("WaterSurface"))#,"avgDay"))
View(dfPowellLevelChange)
dfPowellLevelChange <- rbind(dfPowellReleaseElev %>% filter(Month.x == 1,Day==1),
dfPowellReleaseElev %>% filter(Month.x == 12,Day==31))
dfPowellReleaseElev <- left_join(dfPowellReleaseTempSum,dfPowellHistorical,by = c("DateClean" = "dDate"))
#Convert to numric
dfPowellReleaseElev$WaterSurface <- as.numeric(dfPowellReleaseElev$Elevation..feet.)
#Calculate Water Year
dfPowellReleaseElev$WaterYear <- ifelse(dfPowellReleaseElev$Month.x >= 10, dfPowellReleaseElev$Year.x,dfPowellReleaseElev$Year.x - 1)
dfPowellLevelChange <- rbind(dfPowellReleaseElev %>% filter(Month.x == 1,Day==1),
dfPowellReleaseElev %>% filter(Month.x == 12,Day==31))
View(dfPowellLevelChange)
dfPowellTempChange <- dcast(dfPowellLevelChange,Year.y~Month.y , mean, value.var = "avgDay")
dfPowellLevelChange <- dcast(dfPowellLevelChange,Year.y~Month.y , mean, value.var = c("WaterSurface"))#,"avgDay"))
#Classify water level changes for each year
dfPowellLevelChange$LevelYearType <- ifelse(dfPowellLevelChange$Dec - dfPowellLevelChange$Jan > nMargin,"Rise",ifelse(dfPowellLevelChange$Dec - dfPowellLevelChange$Jan < -nMargin,"Fall","Steady"))
dfPowellTempChange$TempYearType <- ifelse(dfPowellTempChange$Dec - dfPowellTempChange$Jan > nTempMargin,"Rise",ifelse(dfPowellTempChange$Dec - dfPowellTempChange$Jan < -nTempMargin,"Fall","Steady"))
dfPowellLevelChange <- left_join(dfPowellLevelChange,dfPowellTempChange,by=c("Year" = "Year"))
dfPowellLevelChange <- left_join(dfPowellLevelChange,dfPowellTempChange,by=c("Year.y" = "Year.y"))
dfPowellReleaseElev <- left_join(dfPowellReleaseElev,dfPowellLevelChange[,c(1,4,7)], by=c("Year.y" = "Year.y"))
dfPowellReleaseElev <- transform(dfPowellReleaseElev, LevelYearType = factor(LevelYearType,c("Fall","Steady","Rise")))
dfPowellReleaseElev <- transform(dfPowellReleaseElev, TempYearType = factor(TempYearType,c("Fall","Steady","Rise")))
ggplot(data=dfPowellReleaseElev %>% filter(Day %in% seq(1,31, by=2), !is.na(LevelYearType), !is.na(TempYearType)) %>% arrange(DateClean) , aes(x=WaterSurface,y=avgDay),color=LevelYearType) +
#geom_line(aes(x=Day,y=avgDay), color="black") +
#Error bar on release data - color by water surface
#geom_errorbar(aes(ymin= minDay, ymax=maxDay, color=WaterYear), size=1) +
geom_errorbar(aes(ymin= minDay, ymax=maxDay, color=as.factor(Month.x)), size=1) +
# Label Oct 1 of each year
#geom_text(data=dfPowellReleaseElev %>% filter(Month.x==10,Day==1, !is.na(LevelYearType), !is.na(TempYearType)), aes(x=WaterSurface,y=avgDay,label=WaterYear),color="Purple", size=4) +
geom_text_repel(data=dfPowellReleaseElev %>% filter(Month.x==10,Day==1, !is.na(LevelYearType), !is.na(TempYearType)), aes(x=WaterSurface,y=avgDay,label=WaterYear),color="Purple", size=4) +
geom_point(data=dfPowellReleaseElev %>% filter(Month.x==1,Day==1, !is.na(LevelYearType), !is.na(TempYearType)), aes(x=WaterSurface,y=avgDay),color="purple") +
#1:1 line
#geom_abline(intercept = 0, slope = 1, color="red", linetype = "longdash", size = 1.5) +
#coord_fixed(ratio=1) +
#scale_x_discrete(breaks = c(3370, seq(3400,3720, by=50))) +
scale_y_continuous(sec.axis = sec_axis(~. +0 ,name="Temperature Change", breaks=c(0), labels = c(""))) +
scale_x_continuous(sec.axis = sec_axis(~. +0 ,name="Water Level Change", breaks=c(0), labels = c(""))) +
#facet_grid(Month ~ Year) +
#Color scale - "summer" months in red
scale_color_manual(values=c(rep(palBlues[9],3), rep("Red",8), rep(palBlues[9],1))) +
#scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color") +
#scale_color_manual(values = c("Red","Blue","grey75", "grey50")) +
labs(x="Water Surface Elevation (feet)", y="Release Temperature (oC)", color="Month") +
#labs(x="Temperature at Wahweap @ 3,490 ft (oC)", y="Release Temperature (oC)", color="") +
facet_grid( TempYearType ~ LevelYearType) +
theme(text = element_text(size=18), legend.text=element_text(size=16),
legend.key = element_blank())
ggplot(data=dfPowellReleaseElev %>% filter(Day %in% seq(1,31, by=2), !is.na(LevelYearType), !is.na(TempYearType)) %>% arrange(DateClean) , aes(x=WaterSurface,y=avgDay),color=LevelYearType) +
#geom_line(aes(x=Day,y=avgDay), color="black") +
#Error bar on release data - color by water surface
#geom_errorbar(aes(ymin= minDay, ymax=maxDay, color=WaterYear), size=1) +
geom_errorbar(aes(ymin= minDay, ymax=maxDay, color=as.factor(Month.x)), size=1) +
# Label Oct 1 of each year
#geom_text(data=dfPowellReleaseElev %>% filter(Month.x==10,Day==1, !is.na(LevelYearType), !is.na(TempYearType)), aes(x=WaterSurface,y=avgDay,label=WaterYear),color="Purple", size=4) +
geom_text_repel(data=dfPowellReleaseElev %>% filter(Month.x==1,Day==1, !is.na(LevelYearType), !is.na(TempYearType)), aes(x=WaterSurface,y=avgDay,label=WaterYear),color="Purple", size=4) +
geom_point(data=dfPowellReleaseElev %>% filter(Month.x==1,Day==1, !is.na(LevelYearType), !is.na(TempYearType)), aes(x=WaterSurface,y=avgDay),color="purple") +
#1:1 line
#geom_abline(intercept = 0, slope = 1, color="red", linetype = "longdash", size = 1.5) +
#coord_fixed(ratio=1) +
#scale_x_discrete(breaks = c(3370, seq(3400,3720, by=50))) +
scale_y_continuous(sec.axis = sec_axis(~. +0 ,name="Temperature Change", breaks=c(0), labels = c(""))) +
scale_x_continuous(sec.axis = sec_axis(~. +0 ,name="Water Level Change", breaks=c(0), labels = c(""))) +
#facet_grid(Month ~ Year) +
#Color scale - "summer" months in red
scale_color_manual(values=c(rep(palBlues[9],3), rep("Red",8), rep(palBlues[9],1))) +
#scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color") +
#scale_color_manual(values = c("Red","Blue","grey75", "grey50")) +
labs(x="Water Surface Elevation (feet)", y="Release Temperature (oC)", color="Month") +
#labs(x="Temperature at Wahweap @ 3,490 ft (oC)", y="Release Temperature (oC)", color="") +
facet_grid( TempYearType ~ LevelYearType) +
theme(text = element_text(size=18), legend.text=element_text(size=16),
legend.key = element_blank())
which.min(dfPowellReleaseTempSum$avgDay)
dfPowellReleaseTempSum #%> group_by(Year) %>% summarize(DateMinTemp = which.min(avgDay))
dfTemp <- dfPowellReleaseTempSum #%> group_by(Year) %>% summarize(DateMinTemp = which.min(avgDay))
View(dfTemp)
dfTemp <- dfPowellReleaseTempSum %>% group_by(Year) %>% summarize(DateMinTemp = which.min(avgDay))
dfTemp <- dfPowellReleaseTempSum %>% group_by(Year) %>% summarize(DateMinTemp = which.min(avgDay), DateMaxTemp = which.max(avgDay))
dfMinMax <- dfPowellReleaseTempSum %>% group_by(Year) %>%
summarize(DateMinTemp = which.min(avgDay), DateMaxTemp = which.max(avgDay),
DateMinLevel = which.min(WaterSurface), DateMaxLevel = which.max(WaterSurface))
View(dfPowellReleaseTempSum)
View(dfPowellReleaseTempSum)
dfMinMax <- dfPowellReleaseElev %>% group_by(Year) %>%
summarize(DateMinTemp = which.min(avgDay), DateMaxTemp = which.max(avgDay),
DateMinLevel = which.min(WaterSurface), DateMaxLevel = which.max(WaterSurface))
dfMinMax <- dfPowellReleaseElev %>% group_by(Year.x) %>%
summarize(DateMinTemp = which.min(avgDay), DateMaxTemp = which.max(avgDay),
DateMinLevel = which.min(WaterSurface), DateMaxLevel = which.max(WaterSurface))
View(dfMinMax)
