#scale_y_continuous(limits = c(3370,3700), breaks = seq(3250,3711, by=50),labels=seq(3250,3711, by=50),  sec.axis = sec_axis(~. +0, name = "Active Storage\n(million acre-feet)", breaks = dfPowellZonesMinusTop$level_feet, labels = dfPowellZonesMinusTop$rightlabel )) +
scale_x_continuous(limits = c(1,12), breaks = seq(1,12,by=1)) +
#Vertical line at temperature breaks
#geom_vline(xintercept=c(15,18)) +
theme(text = element_text(size=18), legend.text=element_text(size=16))
cCategories <- c("<15", "<18",">18","Base")
dfTestElevBar <- (data.frame(Month.x = seq(1,12,by=1), TempCategory = "Base" , ElevationAdd = 3490)) # Base entry
dfTestElevBar2 <- as.data.frame(dfTestElev %>% filter(Temperature == 18) %>% mutate(Month.x = Month.x, TempCategory = ">18", ElevationAdd = maxElevation - 3490) %>% select(Month.x, TempCategory, ElevationAdd))
dfTestElevBar3 <- as.data.frame(dfTestElev %>% filter(Temperature == 18) %>% mutate(Month.x = Month.x, TempCategory = "<18", ElevationAdd = Range) %>% select(Month.x, TempCategory, ElevationAdd))
dfTestElevBar4 <- as.data.frame(dfTestElev %>% filter(Temperature == 15) %>% mutate(Month.x = Month.x, TempCategory = "<15", ElevationAdd = 3700 - minElevation) %>% select(Month.x, TempCategory, ElevationAdd))
dfTestElevBar <- as.data.frame(rbind(dfTestElevBar, dfTestElevBar2, dfTestElevBar3, dfTestElevBar4))
ggplot(data=dfTestElevBar) +
#Range of elevation for specified water temperature
geom_bar(aes(x=Month.x, y=ElevationAdd, fill=as.factor(TempCategory)), stat = "identity") +
#geom_ribbon(aes(x=Month.x, ymin= minElevation, ymax=maxElevation, fill=as.factor(Temperature))) +
scale_fill_manual(values = c("white", "blue","red", "pink"), breaks = cCategories) +
#scale_color_manual(values = c("blue","red")) +
labs(y="Water Surface Elevation (feet)", x="Month", fill="Turbine Release\nTemperature (oC)", linetype="", shape="") +
#labs(x="Temperature at Wahweap @ 3,490 ft (oC)", y="Turbine Release Temperature (oC)", color="") +
#scale_y_continuous(limits = c(3370,3700), breaks = seq(3250,3711, by=50),labels=seq(3250,3711, by=50),  sec.axis = sec_axis(~. +0, name = "Active Storage\n(million acre-feet)", breaks = dfPowellZonesMinusTop$level_feet, labels = dfPowellZonesMinusTop$rightlabel )) +
scale_x_continuous(limits = c(1,12), breaks = seq(1,12,by=1)) +
#Vertical line at temperature breaks
#geom_vline(xintercept=c(15,18)) +
theme(text = element_text(size=18), legend.text=element_text(size=16)
ggplot(data=dfTestElevBar) +
#Range of elevation for specified water temperature
geom_bar(aes(x=Month.x, y=ElevationAdd, fill=as.factor(TempCategory), group = TempCategory), stat = "identity") +
#geom_ribbon(aes(x=Month.x, ymin= minElevation, ymax=maxElevation, fill=as.factor(Temperature))) +
scale_fill_manual(values = c("white", "blue","red", "pink"), breaks = cCategories) +
#scale_color_manual(values = c("blue","red")) +
labs(y="Water Surface Elevation (feet)", x="Month", fill="Turbine Release\nTemperature (oC)", linetype="", shape="") +
#labs(x="Temperature at Wahweap @ 3,490 ft (oC)", y="Turbine Release Temperature (oC)", color="") +
#scale_y_continuous(limits = c(3370,3700), breaks = seq(3250,3711, by=50),labels=seq(3250,3711, by=50),  sec.axis = sec_axis(~. +0, name = "Active Storage\n(million acre-feet)", breaks = dfPowellZonesMinusTop$level_feet, labels = dfPowellZonesMinusTop$rightlabel )) +
scale_x_continuous(limits = c(1,12), breaks = seq(1,12,by=1)) +
#Vertical line at temperature breaks
#geom_vline(xintercept=c(15,18)) +
theme(text = element_text(size=18), legend.text=element_text(size=16)) #,
ggplot(data=dfTestElevBar) +
#Range of elevation for specified water temperature
geom_bar(aes(x=Month.x, y=ElevationAdd, fill=as.factor(TempCategory), group = TempCategory), stat = "identity") +
#geom_ribbon(aes(x=Month.x, ymin= minElevation, ymax=maxElevation, fill=as.factor(Temperature))) +
scale_fill_manual(values = c("white", "blue","red", "pink"), breaks = cCategories)
ggplot(data=dfTestElevBar) +
#Range of elevation for specified water temperature
geom_bar(aes(x=Month.x, y=ElevationAdd, fill=as.factor(TempCategory), group = TempCategory), stat = "identity") +
#geom_ribbon(aes(x=Month.x, ymin= minElevation, ymax=maxElevation, fill=as.factor(Temperature))) +
scale_fill_manual(values = c("white", "blue","red", "pink"), breaks = cCategories) +
#scale_color_manual(values = c("blue","red")) +
labs(y="Water Surface Elevation (feet)", x="Month", fill="Turbine Release\nTemperature (oC)", linetype="", shape="") +
#labs(x="Temperature at Wahweap @ 3,490 ft (oC)", y="Turbine Release Temperature (oC)", color="") +
#scale_y_continuous(limits = c(3370,3700), breaks = seq(3250,3711, by=50),labels=seq(3250,3711, by=50),  sec.axis = sec_axis(~. +0, name = "Active Storage\n(million acre-feet)", breaks = dfPowellZonesMinusTop$level_feet, labels = dfPowellZonesMinusTop$rightlabel )) +
scale_x_continuous(limits = c(1,12), breaks = seq(1,12,by=1)) +
#Vertical line at temperature breaks
#geom_vline(xintercept=c(15,18)) +
theme(text = element_text(size=18), legend.text=element_text(size=16))
ggplot(data=dfTestElevBar[order(dfTestElevBar$TempCategory, decreasing = T),]) +
#Range of elevation for specified water temperature
geom_bar(aes(x=Month.x, y=ElevationAdd, fill=as.factor(TempCategory)), stat = "identity") +
#geom_ribbon(aes(x=Month.x, ymin= minElevation, ymax=maxElevation, fill=as.factor(Temperature))) +
scale_fill_manual(values = c("white", "blue","red", "pink"), breaks = cCategories) +
#scale_color_manual(values = c("blue","red")) +
labs(y="Water Surface Elevation (feet)", x="Month", fill="Turbine Release\nTemperature (oC)", linetype="", shape="") +
#labs(x="Temperature at Wahweap @ 3,490 ft (oC)", y="Turbine Release Temperature (oC)", color="") +
#scale_y_continuous(limits = c(3370,3700), breaks = seq(3250,3711, by=50),labels=seq(3250,3711, by=50),  sec.axis = sec_axis(~. +0, name = "Active Storage\n(million acre-feet)", breaks = dfPowellZonesMinusTop$level_feet, labels = dfPowellZonesMinusTop$rightlabel )) +
scale_x_continuous(limits = c(1,12), breaks = seq(1,12,by=1)) +
#Vertical line at temperature breaks
#geom_vline(xintercept=c(15,18)) +
theme(text = element_text(size=18), legend.text=element_text(size=16)) #,
ggplot(data=dfTestElevBar[order(dfTestElevBar$TempCategory, decreasing = F),]) +
#Range of elevation for specified water temperature
geom_bar(aes(x=Month.x, y=ElevationAdd, fill=as.factor(TempCategory)), stat = "identity") +
#geom_ribbon(aes(x=Month.x, ymin= minElevation, ymax=maxElevation, fill=as.factor(Temperature))) +
scale_fill_manual(values = c("white", "blue","red", "pink"), breaks = cCategories) +
#scale_color_manual(values = c("blue","red")) +
labs(y="Water Surface Elevation (feet)", x="Month", fill="Turbine Release\nTemperature (oC)", linetype="", shape="") +
#labs(x="Temperature at Wahweap @ 3,490 ft (oC)", y="Turbine Release Temperature (oC)", color="") +
#scale_y_continuous(limits = c(3370,3700), breaks = seq(3250,3711, by=50),labels=seq(3250,3711, by=50),  sec.axis = sec_axis(~. +0, name = "Active Storage\n(million acre-feet)", breaks = dfPowellZonesMinusTop$level_feet, labels = dfPowellZonesMinusTop$rightlabel )) +
scale_x_continuous(limits = c(1,12), breaks = seq(1,12,by=1)) +
#Vertical line at temperature breaks
#geom_vline(xintercept=c(15,18)) +
theme(text = element_text(size=18), legend.text=element_text(size=16))
order(dfTestElevBar$TempCategory, decreasing = F)
order(dfTestElevBar$TempCategory, decreasing = T)
dfTestElevBar$TempCategory
gplot(data=dfTestElevBar[order(dfTestElevBar$TempCategory, decreasing = F),]) +
#Range of elevation for specified water temperature
geom_bar(aes(x=Month.x, y=ElevationAdd, fill=as.factor(TempCategory), group = TempCategory), stat = "identity") +
#geom_ribbon(aes(x=Month.x, ymin= minElevation, ymax=maxElevation, fill=as.factor(Temperature))) +
scale_fill_manual(values = c("white", "blue","red", "pink"), breaks = cCategories) +
#scale_color_manual(values = c("blue","red")) +
labs(y="Water Surface Elevation (feet)", x="Month", fill="Turbine Release\nTemperature (oC)", linetype="", shape="") +
#labs(x="Temperature at Wahweap @ 3,490 ft (oC)", y="Turbine Release Temperature (oC)", color="") +
#scale_y_continuous(limits = c(3370,3700), breaks = seq(3250,3711, by=50),labels=seq(3250,3711, by=50),  sec.axis = sec_axis(~. +0, name = "Active Storage\n(million acre-feet)", breaks = dfPowellZonesMinusTop$level_feet, labels = dfPowellZonesMinusTop$rightlabel )) +
scale_x_continuous(limits = c(1,12), breaks = seq(1,12,by=1)) +
#Vertical line at temperature breaks
#geom_vline(xintercept=c(15,18)) +
theme(text = element_text(size=18), legend.text=element_text(size=16)) #,
ggplot(data=dfTestElevBar[order(dfTestElevBar$TempCategory, decreasing = T),]) +
#Range of elevation for specified water temperature
geom_bar(aes(x=Month.x, y=ElevationAdd, fill=as.factor(TempCategory), group = TempCategory), stat = "identity") +
#geom_ribbon(aes(x=Month.x, ymin= minElevation, ymax=maxElevation, fill=as.factor(Temperature))) +
scale_fill_manual(values = c("white", "blue","red", "pink"), breaks = cCategories) +
#scale_color_manual(values = c("blue","red")) +
labs(y="Water Surface Elevation (feet)", x="Month", fill="Turbine Release\nTemperature (oC)", linetype="", shape="") +
#labs(x="Temperature at Wahweap @ 3,490 ft (oC)", y="Turbine Release Temperature (oC)", color="") +
#scale_y_continuous(limits = c(3370,3700), breaks = seq(3250,3711, by=50),labels=seq(3250,3711, by=50),  sec.axis = sec_axis(~. +0, name = "Active Storage\n(million acre-feet)", breaks = dfPowellZonesMinusTop$level_feet, labels = dfPowellZonesMinusTop$rightlabel )) +
scale_x_continuous(limits = c(1,12), breaks = seq(1,12,by=1)) +
#Vertical line at temperature breaks
#geom_vline(xintercept=c(15,18)) +
theme(text = element_text(size=18), legend.text=element_text(size=16))
ggplot(data=dfTestElevBar) +  #[order(dfTestElevBar$TempCategory, decreasing = T),]
#Range of elevation for specified water temperature
geom_bar(aes(x=Month.x, y=ElevationAdd, fill=as.factor(TempCategory), group = TempCategory), stat = "identity") +
#geom_ribbon(aes(x=Month.x, ymin= minElevation, ymax=maxElevation, fill=as.factor(Temperature))) +
scale_fill_manual(values = c("white", "blue","red", "pink"), breaks = cCategories) +
#scale_color_manual(values = c("blue","red")) +
labs(y="Water Surface Elevation (feet)", x="Month", fill="Turbine Release\nTemperature (oC)", linetype="", shape="") +
#labs(x="Temperature at Wahweap @ 3,490 ft (oC)", y="Turbine Release Temperature (oC)", color="") +
#scale_y_continuous(limits = c(3370,3700), breaks = seq(3250,3711, by=50),labels=seq(3250,3711, by=50),  sec.axis = sec_axis(~. +0, name = "Active Storage\n(million acre-feet)", breaks = dfPowellZonesMinusTop$level_feet, labels = dfPowellZonesMinusTop$rightlabel )) +
scale_x_continuous(limits = c(1,12), breaks = seq(1,12,by=1)) +
#Vertical line at temperature breaks
#geom_vline(xintercept=c(15,18)) +
theme(text = element_text(size=18), legend.text=element_text(size=16))
dfTestElevBar <- (data.frame(Month.x = seq(1,12,by=1), TempCategory = "Base" , ElevationAdd = 3490)) # Base entry
dfTestElevBar2 <- as.data.frame(dfTestElev %>% filter(Temperature == 18) %>% mutate(Month.x = Month.x, TempCategory = ">18", ElevationAdd = maxElevation - 3490) %>% select(Month.x, TempCategory, ElevationAdd))
dfTestElevBar3 <- as.data.frame(dfTestElev %>% filter(Temperature == 18) %>% mutate(Month.x = Month.x, TempCategory = "<18", ElevationAdd = Range) %>% select(Month.x, TempCategory, ElevationAdd))
dfTestElevBar4 <- as.data.frame(dfTestElev %>% filter(Temperature == 15) %>% mutate(Month.x = Month.x, TempCategory = "<15", ElevationAdd = 3700 - maxElevation) %>% select(Month.x, TempCategory, ElevationAdd))
dfTestElevBar <- as.data.frame(rbind(dfTestElevBar, dfTestElevBar2, dfTestElevBar3, dfTestElevBar4))
ggplot(data=dfTestElevBar) +  #[order(dfTestElevBar$TempCategory, decreasing = T),]
#Range of elevation for specified water temperature
geom_bar(aes(x=Month.x, y=ElevationAdd, fill=as.factor(TempCategory), group = TempCategory), stat = "identity") +
#geom_ribbon(aes(x=Month.x, ymin= minElevation, ymax=maxElevation, fill=as.factor(Temperature))) +
scale_fill_manual(values = c("white", "blue","red", "pink"), breaks = cCategories) +
#scale_color_manual(values = c("blue","red")) +
labs(y="Water Surface Elevation (feet)", x="Month", fill="Turbine Release\nTemperature (oC)", linetype="", shape="") +
#labs(x="Temperature at Wahweap @ 3,490 ft (oC)", y="Turbine Release Temperature (oC)", color="") +
#scale_y_continuous(limits = c(3370,3700), breaks = seq(3250,3711, by=50),labels=seq(3250,3711, by=50),  sec.axis = sec_axis(~. +0, name = "Active Storage\n(million acre-feet)", breaks = dfPowellZonesMinusTop$level_feet, labels = dfPowellZonesMinusTop$rightlabel )) +
scale_x_continuous(limits = c(1,12), breaks = seq(1,12,by=1)) +
#Vertical line at temperature breaks
#geom_vline(xintercept=c(15,18)) +
theme(text = element_text(size=18), legend.text=element_text(size=16))
dfTestElevBar <- (data.frame(Month.x = seq(1,12,by=1), TempCategory = "Base" , ElevationAdd = 3490)) # Base entry
dfTestElevBar2 <- as.data.frame(dfTestElev %>% filter(Temperature == 18) %>% mutate(Month.x = Month.x, TempCategory = ">18", ElevationAdd = minElevation - 3490) %>% select(Month.x, TempCategory, ElevationAdd))
dfTestElevBar3 <- as.data.frame(dfTestElev %>% filter(Temperature == 18) %>% mutate(Month.x = Month.x, TempCategory = "<18", ElevationAdd = Range) %>% select(Month.x, TempCategory, ElevationAdd))
dfTestElevBar4 <- as.data.frame(dfTestElev %>% filter(Temperature == 15) %>% mutate(Month.x = Month.x, TempCategory = "<15", ElevationAdd = 3700 - maxElevation) %>% select(Month.x, TempCategory, ElevationAdd))
dfTestElevBar <- as.data.frame(rbind(dfTestElevBar, dfTestElevBar2, dfTestElevBar3, dfTestElevBar4))
ggplot(data=dfTestElevBar) +  #[order(dfTestElevBar$TempCategory, decreasing = T),]
#Range of elevation for specified water temperature
geom_bar(aes(x=Month.x, y=ElevationAdd, fill=as.factor(TempCategory), group = TempCategory), stat = "identity") +
#geom_ribbon(aes(x=Month.x, ymin= minElevation, ymax=maxElevation, fill=as.factor(Temperature))) +
scale_fill_manual(values = c("white", "blue","red", "pink"), breaks = cCategories) +
#scale_color_manual(values = c("blue","red")) +
labs(y="Water Surface Elevation (feet)", x="Month", fill="Turbine Release\nTemperature (oC)", linetype="", shape="") +
#labs(x="Temperature at Wahweap @ 3,490 ft (oC)", y="Turbine Release Temperature (oC)", color="") +
#scale_y_continuous(limits = c(3370,3700), breaks = seq(3250,3711, by=50),labels=seq(3250,3711, by=50),  sec.axis = sec_axis(~. +0, name = "Active Storage\n(million acre-feet)", breaks = dfPowellZonesMinusTop$level_feet, labels = dfPowellZonesMinusTop$rightlabel )) +
scale_x_continuous(limits = c(1,12), breaks = seq(1,12,by=1)) +
#Vertical line at temperature breaks
#geom_vline(xintercept=c(15,18)) +
theme(text = element_text(size=18), legend.text=element_text(size=16))
dfTestElev$minElevNextT <- dplyr::lead(dfTestElev$minElevation)
dfTestElev$minElevNextT <- dplyr::lead(dfTestElev %>% group_by(Month.x,Temperature) %>% select(minElevation))
dfTestElev$minElevNextT <- dplyr::lead(dfTestElev$minElevation[order(dfTestElev$Month.x, dfTestElev$Temperature)])
dfTestElev <- dfTestElev[order(dfTestElev$Month.x, dfTestElev$Temperure),]
dfTestElev <- dfTestElev[order(dfTestElev$Month.x, dfTestElev$Temperature),]
View(dfTestElev)
dfTestElev$minElevNextT <- dplyr::lead(dfTestElev$minElevation)
dfTestElev <- dfTestElev[order(dfTestElev$Month.x, dfTestElev$Temperature),]
dfTestElev$minElevNextT <- dplyr::lead(dfTestElev$minElevation)
dfTestElevBar <- (data.frame(Month.x = seq(1,12,by=1), TempCategory = "Base" , ElevationAdd = 3490)) # Base entry
dfTestElevBar2 <- as.data.frame(dfTestElev %>% filter(Temperature == 18) %>% mutate(Month.x = Month.x, TempCategory = ">18", ElevationAdd = minElevation - 3490) %>% select(Month.x, TempCategory, ElevationAdd))
dfTestElevBar3 <- as.data.frame(dfTestElev %>% filter(Temperature == 18) %>% mutate(Month.x = Month.x, TempCategory = "<18", ElevationAdd = minElevNextT - minElevation) %>% select(Month.x, TempCategory, ElevationAdd))
dfTestElevBar4 <- as.data.frame(dfTestElev %>% filter(Temperature == 15) %>% mutate(Month.x = Month.x, TempCategory = "<15", ElevationAdd = 3700 - maxElevation) %>% select(Month.x, TempCategory, ElevationAdd))
dfTestElevBar <- as.data.frame(rbind(dfTestElevBar, dfTestElevBar2, dfTestElevBar3, dfTestElevBar4))
ggplot(data=dfTestElevBar) +  #[order(dfTestElevBar$TempCategory, decreasing = T),]
#Range of elevation for specified water temperature
geom_bar(aes(x=Month.x, y=ElevationAdd, fill=as.factor(TempCategory), group = TempCategory), stat = "identity") +
#geom_ribbon(aes(x=Month.x, ymin= minElevation, ymax=maxElevation, fill=as.factor(Temperature))) +
scale_fill_manual(values = c("white", "blue","red", "pink"), breaks = cCategories) +
#scale_color_manual(values = c("blue","red")) +
labs(y="Water Surface Elevation (feet)", x="Month", fill="Turbine Release\nTemperature (oC)", linetype="", shape="") +
#labs(x="Temperature at Wahweap @ 3,490 ft (oC)", y="Turbine Release Temperature (oC)", color="") +
#scale_y_continuous(limits = c(3370,3700), breaks = seq(3250,3711, by=50),labels=seq(3250,3711, by=50),  sec.axis = sec_axis(~. +0, name = "Active Storage\n(million acre-feet)", breaks = dfPowellZonesMinusTop$level_feet, labels = dfPowellZonesMinusTop$rightlabel )) +
scale_x_continuous(limits = c(1,12), breaks = seq(1,12,by=1)) +
#Vertical line at temperature breaks
#geom_vline(xintercept=c(15,18)) +
theme(text = element_text(size=18), legend.text=element_text(size=16))
3700 -3490
dfTestElevBar %>% group_by(Month.x) %>% summarize(TotElev = sum(ElevationAdd))
dfTestElev <- dfTestElev[order(dfTestElev$Month.x, dfTestElev$Temperature),]
dfTestElev$minElevNextT <- dplyr::lag(dfTestElev$minElevation)
dfTestElevBar <- (data.frame(Month.x = seq(1,12,by=1), TempCategory = "Base" , ElevationAdd = 3490)) # Base entry
dfTestElevBar2 <- as.data.frame(dfTestElev %>% filter(Temperature == 18) %>% mutate(Month.x = Month.x, TempCategory = ">18", ElevationAdd = minElevation - 3490) %>% select(Month.x, TempCategory, ElevationAdd))
dfTestElevBar3 <- as.data.frame(dfTestElev %>% filter(Temperature == 18) %>% mutate(Month.x = Month.x, TempCategory = "<18", ElevationAdd = minElevNextT - minElevation) %>% select(Month.x, TempCategory, ElevationAdd))
dfTestElevBar4 <- as.data.frame(dfTestElev %>% filter(Temperature == 15) %>% mutate(Month.x = Month.x, TempCategory = "<15", ElevationAdd = 3700 - maxElevation) %>% select(Month.x, TempCategory, ElevationAdd))
dfTestElevBar <- as.data.frame(rbind(dfTestElevBar, dfTestElevBar2, dfTestElevBar3, dfTestElevBar4))
ggplot(data=dfTestElevBar) +  #[order(dfTestElevBar$TempCategory, decreasing = T),]
#Range of elevation for specified water temperature
geom_bar(aes(x=Month.x, y=ElevationAdd, fill=as.factor(TempCategory), group = TempCategory), stat = "identity") +
#geom_ribbon(aes(x=Month.x, ymin= minElevation, ymax=maxElevation, fill=as.factor(Temperature))) +
scale_fill_manual(values = c("white", "blue","red", "pink"), breaks = cCategories) +
#scale_color_manual(values = c("blue","red")) +
labs(y="Water Surface Elevation (feet)", x="Month", fill="Turbine Release\nTemperature (oC)", linetype="", shape="") +
#labs(x="Temperature at Wahweap @ 3,490 ft (oC)", y="Turbine Release Temperature (oC)", color="") +
#scale_y_continuous(limits = c(3370,3700), breaks = seq(3250,3711, by=50),labels=seq(3250,3711, by=50),  sec.axis = sec_axis(~. +0, name = "Active Storage\n(million acre-feet)", breaks = dfPowellZonesMinusTop$level_feet, labels = dfPowellZonesMinusTop$rightlabel )) +
scale_x_continuous(limits = c(1,12), breaks = seq(1,12,by=1)) +
#Vertical line at temperature breaks
#geom_vline(xintercept=c(15,18)) +
theme(text = element_text(size=18), legend.text=element_text(size=16)) #,
#Sum by group to check
dfTestElevBar %>% group_by(Month.x) %>% summarize(TotElev = sum(ElevationAdd))
3700 - 3503.889
dfTestElevBar <- (data.frame(Month.x = seq(1,12,by=1), TempCategory = "Base" , ElevationAdd = 3490)) # Base entry
dfTestElevBar2 <- as.data.frame(dfTestElev %>% filter(Temperature == 18) %>% mutate(Month.x = Month.x, TempCategory = ">18", ElevationAdd = minElevation - 3490) %>% select(Month.x, TempCategory, ElevationAdd))
dfTestElevBar3 <- as.data.frame(dfTestElev %>% filter(Temperature == 18) %>% mutate(Month.x = Month.x, TempCategory = "<18", ElevationAdd = minElevNextT - maxElevation) %>% select(Month.x, TempCategory, ElevationAdd))
dfTestElevBar4 <- as.data.frame(dfTestElev %>% filter(Temperature == 15) %>% mutate(Month.x = Month.x, TempCategory = "<15", ElevationAdd = 3700 - maxElevation) %>% select(Month.x, TempCategory, ElevationAdd))
dfTestElevBar <- as.data.frame(rbind(dfTestElevBar, dfTestElevBar2, dfTestElevBar3, dfTestElevBar4))
ggplot(data=dfTestElevBar) +  #[order(dfTestElevBar$TempCategory, decreasing = T),]
#Range of elevation for specified water temperature
geom_bar(aes(x=Month.x, y=ElevationAdd, fill=as.factor(TempCategory), group = TempCategory), stat = "identity") +
#geom_ribbon(aes(x=Month.x, ymin= minElevation, ymax=maxElevation, fill=as.factor(Temperature))) +
scale_fill_manual(values = c("white", "blue","red", "pink"), breaks = cCategories) +
#scale_color_manual(values = c("blue","red")) +
labs(y="Water Surface Elevation (feet)", x="Month", fill="Turbine Release\nTemperature (oC)", linetype="", shape="") +
#labs(x="Temperature at Wahweap @ 3,490 ft (oC)", y="Turbine Release Temperature (oC)", color="") +
#scale_y_continuous(limits = c(3370,3700), breaks = seq(3250,3711, by=50),labels=seq(3250,3711, by=50),  sec.axis = sec_axis(~. +0, name = "Active Storage\n(million acre-feet)", breaks = dfPowellZonesMinusTop$level_feet, labels = dfPowellZonesMinusTop$rightlabel )) +
scale_x_continuous(limits = c(1,12), breaks = seq(1,12,by=1)) +
#Vertical line at temperature breaks
#geom_vline(xintercept=c(15,18)) +
theme(text = element_text(size=18), legend.text=element_text(size=16)) #,
#Sum by group to check
dfTestElevBar %>% group_by(Month.x) %>% summarize(TotElev = sum(ElevationAdd))
3490 + 196.11
dfTestElev <- dfTestElev[order(dfTestElev$Month.x, dfTestElev$Temperature),]
dfTestElev$maxElevNextT <- dplyr::lag(dfTestElev$maxElevation)
dfTestElevBar <- (data.frame(Month.x = seq(1,12,by=1), TempCategory = "Base" , ElevationAdd = 3490)) # Base entry
dfTestElevBar2 <- as.data.frame(dfTestElev %>% filter(Temperature == 18) %>% mutate(Month.x = Month.x, TempCategory = ">18", ElevationAdd = minElevation - 3490) %>% select(Month.x, TempCategory, ElevationAdd))
dfTestElevBar3 <- as.data.frame(dfTestElev %>% filter(Temperature == 18) %>% mutate(Month.x = Month.x, TempCategory = "<18", ElevationAdd = maxElevNextT - maxElevation) %>% select(Month.x, TempCategory, ElevationAdd))
dfTestElevBar4 <- as.data.frame(dfTestElev %>% filter(Temperature == 15) %>% mutate(Month.x = Month.x, TempCategory = "<15", ElevationAdd = 3700 - maxElevation) %>% select(Month.x, TempCategory, ElevationAdd))
dfTestElevBar <- as.data.frame(rbind(dfTestElevBar, dfTestElevBar2, dfTestElevBar3, dfTestElevBar4))
ggplot(data=dfTestElevBar) +  #[order(dfTestElevBar$TempCategory, decreasing = T),]
#Range of elevation for specified water temperature
geom_bar(aes(x=Month.x, y=ElevationAdd, fill=as.factor(TempCategory), group = TempCategory), stat = "identity") +
#geom_ribbon(aes(x=Month.x, ymin= minElevation, ymax=maxElevation, fill=as.factor(Temperature))) +
scale_fill_manual(values = c("white", "blue","red", "pink"), breaks = cCategories) +
#scale_color_manual(values = c("blue","red")) +
labs(y="Water Surface Elevation (feet)", x="Month", fill="Turbine Release\nTemperature (oC)", linetype="", shape="") +
#labs(x="Temperature at Wahweap @ 3,490 ft (oC)", y="Turbine Release Temperature (oC)", color="") +
#scale_y_continuous(limits = c(3370,3700), breaks = seq(3250,3711, by=50),labels=seq(3250,3711, by=50),  sec.axis = sec_axis(~. +0, name = "Active Storage\n(million acre-feet)", breaks = dfPowellZonesMinusTop$level_feet, labels = dfPowellZonesMinusTop$rightlabel )) +
scale_x_continuous(limits = c(1,12), breaks = seq(1,12,by=1)) +
#Vertical line at temperature breaks
#geom_vline(xintercept=c(15,18)) +
theme(text = element_text(size=18), legend.text=element_text(size=16)) #,
#Sum by group to check
dfTestElevBar %>% group_by(Month.x) %>% summarize(TotElev = sum(ElevationAdd))
dfTestElevBar2 <- as.data.frame(dfTestElev %>% filter(Temperature == 18) %>% mutate(Month.x = Month.x, TempCategory = ">18", ElevationAdd = max(minElevation,3490) - 3490) %>% select(Month.x, TempCategory, ElevationAdd))
dfTestElev <- dfTestElev[order(dfTestElev$Month.x, dfTestElev$Temperature),]
dfTestElev$maxElevNextT <- dplyr::lag(dfTestElev$maxElevation)
dfTestElevBar <- (data.frame(Month.x = seq(1,12,by=1), TempCategory = "Base" , ElevationAdd = 3490)) # Base entry
dfTestElevBar2 <- as.data.frame(dfTestElev %>% filter(Temperature == 18) %>% mutate(Month.x = Month.x, TempCategory = ">18", ElevationAdd = max(minElevation,3490) - 3490) %>% select(Month.x, TempCategory, ElevationAdd))
dfTestElevBar3 <- as.data.frame(dfTestElev %>% filter(Temperature == 18) %>% mutate(Month.x = Month.x, TempCategory = "<18", ElevationAdd = maxElevNextT - minElevation) %>% select(Month.x, TempCategory, ElevationAdd))
dfTestElevBar4 <- as.data.frame(dfTestElev %>% filter(Temperature == 15) %>% mutate(Month.x = Month.x, TempCategory = "<15", ElevationAdd = 3700 - maxElevation) %>% select(Month.x, TempCategory, ElevationAdd))
dfTestElevBar <- as.data.frame(rbind(dfTestElevBar, dfTestElevBar2, dfTestElevBar3, dfTestElevBar4))
ggplot(data=dfTestElevBar) +  #[order(dfTestElevBar$TempCategory, decreasing = T),]
#Range of elevation for specified water temperature
geom_bar(aes(x=Month.x, y=ElevationAdd, fill=as.factor(TempCategory), group = TempCategory), stat = "identity") +
#geom_ribbon(aes(x=Month.x, ymin= minElevation, ymax=maxElevation, fill=as.factor(Temperature))) +
scale_fill_manual(values = c("white", "blue","red", "pink"), breaks = cCategories) +
#scale_color_manual(values = c("blue","red")) +
labs(y="Water Surface Elevation (feet)", x="Month", fill="Turbine Release\nTemperature (oC)", linetype="", shape="") +
#labs(x="Temperature at Wahweap @ 3,490 ft (oC)", y="Turbine Release Temperature (oC)", color="") +
#scale_y_continuous(limits = c(3370,3700), breaks = seq(3250,3711, by=50),labels=seq(3250,3711, by=50),  sec.axis = sec_axis(~. +0, name = "Active Storage\n(million acre-feet)", breaks = dfPowellZonesMinusTop$level_feet, labels = dfPowellZonesMinusTop$rightlabel )) +
scale_x_continuous(limits = c(1,12), breaks = seq(1,12,by=1)) +
#Vertical line at temperature breaks
#geom_vline(xintercept=c(15,18)) +
theme(text = element_text(size=18), legend.text=element_text(size=16)) #,
#Sum by group to check
dfTestElevBar %>% group_by(Month.x) %>% summarize(TotElev = sum(ElevationAdd))
ggplot(data=dfTestElevBar) +  #[order(dfTestElevBar$TempCategory, decreasing = T),]
#Range of elevation for specified water temperature
geom_bar(aes(x=Month.x, y=ElevationAdd, fill=as.factor(TempCategory), group = TempCategory), stat = "identity") +
#geom_ribbon(aes(x=Month.x, ymin= minElevation, ymax=maxElevation, fill=as.factor(Temperature))) +
scale_fill_manual(values = c("blue", "pink","red", "white"), breaks = cCategories) +
#scale_color_manual(values = c("blue","red")) +
labs(y="Water Surface Elevation (feet)", x="Month", fill="Turbine Release\nTemperature (oC)", linetype="", shape="") +
#labs(x="Temperature at Wahweap @ 3,490 ft (oC)", y="Turbine Release Temperature (oC)", color="") +
#scale_y_continuous(limits = c(3370,3700), breaks = seq(3250,3711, by=50),labels=seq(3250,3711, by=50),  sec.axis = sec_axis(~. +0, name = "Active Storage\n(million acre-feet)", breaks = dfPowellZonesMinusTop$level_feet, labels = dfPowellZonesMinusTop$rightlabel )) +
scale_x_continuous(limits = c(1,12), breaks = seq(1,12,by=1)) +
#Vertical line at temperature breaks
#geom_vline(xintercept=c(15,18)) +
theme(text = element_text(size=18), legend.text=element_text(size=16)) #,
levels(dfTestElevBar$TempCategory)
dfTestElevBar$TempCategory <- factor(dfTestElevBar$TempCategory, levels = rev(dfTestElevBar$TempCategory) )
dfTestElevBar$TempCategory <- factor(dfTestElevBar$TempCategory, levels = rev(dfTestElevBar$TempCategory) )
ggplot(data=dfTestElevBar) +  #[order(dfTestElevBar$TempCategory, decreasing = T),]
#Range of elevation for specified water temperature
geom_bar(aes(x=Month.x, y=ElevationAdd, fill=fct_rev(as.factor(TempCategory)), group = TempCategory), stat = "identity") +
#geom_ribbon(aes(x=Month.x, ymin= minElevation, ymax=maxElevation, fill=as.factor(Temperature))) +
scale_fill_manual(values = c("blue", "pink","red", "white"), breaks = cCategories) +
#scale_color_manual(values = c("blue","red")) +
labs(y="Water Surface Elevation (feet)", x="Month", fill="Turbine Release\nTemperature (oC)", linetype="", shape="") +
#labs(x="Temperature at Wahweap @ 3,490 ft (oC)", y="Turbine Release Temperature (oC)", color="") +
#scale_y_continuous(limits = c(3370,3700), breaks = seq(3250,3711, by=50),labels=seq(3250,3711, by=50),  sec.axis = sec_axis(~. +0, name = "Active Storage\n(million acre-feet)", breaks = dfPowellZonesMinusTop$level_feet, labels = dfPowellZonesMinusTop$rightlabel )) +
scale_x_continuous(limits = c(1,12), breaks = seq(1,12,by=1)) +
#Vertical line at temperature breaks
#geom_vline(xintercept=c(15,18)) +
theme(text = element_text(size=18), legend.text=element_text(size=16)) #,
#Sum by group to check
dfTestElevBar %>% group_by(Month.x) %>% summarize(TotElev = sum(ElevationAdd))
dfTestElevBar$TempCategory <- factor(dfTestElevBar$TempCategory, levels = cCategories )
ggplot(data=dfTestElevBar) +  #[order(dfTestElevBar$TempCategory, decreasing = T),]
#Range of elevation for specified water temperature
geom_bar(aes(x=Month.x, y=ElevationAdd, fill=TempCategory), group = TempCategory), stat = "identity") +
#geom_ribbon(aes(x=Month.x, ymin= minElevation, ymax=maxElevation, fill=as.factor(Temperature))) +
scale_fill_manual(values = c("blue", "pink","red", "white"), breaks = cCategories) +
#scale_color_manual(values = c("blue","red")) +
labs(y="Water Surface Elevation (feet)", x="Month", fill="Turbine Release\nTemperature (oC)", linetype="", shape="") +
#labs(x="Temperature at Wahweap @ 3,490 ft (oC)", y="Turbine Release Temperature (oC)", color="") +
#scale_y_continuous(limits = c(3370,3700), breaks = seq(3250,3711, by=50),labels=seq(3250,3711, by=50),  sec.axis = sec_axis(~. +0, name = "Active Storage\n(million acre-feet)", breaks = dfPowellZonesMinusTop$level_feet, labels = dfPowellZonesMinusTop$rightlabel )) +
scale_x_continuous(limits = c(1,12), breaks = seq(1,12,by=1)) +
#Vertical line at temperature breaks
#geom_vline(xintercept=c(15,18)) +
theme(text = element_text(size=18), legend.text=element_text(size=16)) #,
#Sum by group to check
dfTestElevBar %>% group_by(Month.x) %>% summarize(TotElev = sum(ElevationAdd))
ggplot(data=dfTestElevBar) +  #[order(dfTestElevBar$TempCategory, decreasing = T),]
#Range of elevation for specified water temperature
geom_bar(aes(x=Month.x, y=ElevationAdd, fill=TempCategory, group = TempCategory), stat = "identity") +
#geom_ribbon(aes(x=Month.x, ymin= minElevation, ymax=maxElevation, fill=as.factor(Temperature))) +
scale_fill_manual(values = c("blue", "pink","red", "white"), breaks = cCategories) +
#scale_color_manual(values = c("blue","red")) +
labs(y="Water Surface Elevation (feet)", x="Month", fill="Turbine Release\nTemperature (oC)", linetype="", shape="") +
#labs(x="Temperature at Wahweap @ 3,490 ft (oC)", y="Turbine Release Temperature (oC)", color="") +
#scale_y_continuous(limits = c(3370,3700), breaks = seq(3250,3711, by=50),labels=seq(3250,3711, by=50),  sec.axis = sec_axis(~. +0, name = "Active Storage\n(million acre-feet)", breaks = dfPowellZonesMinusTop$level_feet, labels = dfPowellZonesMinusTop$rightlabel )) +
scale_x_continuous(limits = c(1,12), breaks = seq(1,12,by=1)) +
#Vertical line at temperature breaks
#geom_vline(xintercept=c(15,18)) +
theme(text = element_text(size=18), legend.text=element_text(size=16)) #,
#Sum by group to check
dfTestElevBar %>% group_by(Month.x) %>% summarize(TotElev = sum(ElevationAdd))
ggplot(data=dfTestElevBar) +  #[order(dfTestElevBar$TempCategory, decreasing = T),]
#Range of elevation for specified water temperature
geom_bar(aes(x=Month.x, y=ElevationAdd, fill=TempCategory, group = TempCategory), stat = "identity") +
#geom_ribbon(aes(x=Month.x, ymin= minElevation, ymax=maxElevation, fill=as.factor(Temperature))) +
scale_fill_manual(values = c("blue", "pink","red", "white"), breaks = cCategories) +
#scale_color_manual(values = c("blue","red")) +
labs(y="Water Surface Elevation (feet)", x="Month", fill="Turbine Release\nTemperature (oC)", linetype="", shape="") +
#labs(x="Temperature at Wahweap @ 3,490 ft (oC)", y="Turbine Release Temperature (oC)", color="") +
scale_y_continuous(limits = c(3370,3700), breaks = seq(3250,3711, by=50),labels=seq(3250,3711, by=50),  sec.axis = sec_axis(~. +0, name = "Active Storage\n(million acre-feet)", breaks = dfPowellZonesMinusTop$level_feet, labels = dfPowellZonesMinusTop$rightlabel )) +
scale_x_continuous(limits = c(1,12), breaks = seq(1,12,by=1)) +
#Vertical line at temperature breaks
#geom_vline(xintercept=c(15,18)) +
theme(text = element_text(size=18), legend.text=element_text(size=16)) #,
ggplot(data=dfTestElevBar) +  #[order(dfTestElevBar$TempCategory, decreasing = T),]
#Range of elevation for specified water temperature
geom_bar(aes(x=Month.x, y=ElevationAdd, fill=TempCategory, group = TempCategory), stat = "identity") +
#geom_ribbon(aes(x=Month.x, ymin= minElevation, ymax=maxElevation, fill=as.factor(Temperature))) +
scale_fill_manual(values = c("blue", "pink","red", "white"), breaks = cCategories) +
#scale_color_manual(values = c("blue","red")) +
labs(y="Water Surface Elevation (feet)", x="Month", fill="Turbine Release\nTemperature (oC)", linetype="", shape="") +
#labs(x="Temperature at Wahweap @ 3,490 ft (oC)", y="Turbine Release Temperature (oC)", color="") +
#scale_y_continuous(limits = c(3370,3700), breaks = seq(3250,3711, by=50),labels=seq(3250,3711, by=50),  sec.axis = sec_axis(~. +0, name = "Active Storage\n(million acre-feet)", breaks = dfPowellZonesMinusTop$level_feet, labels = dfPowellZonesMinusTop$rightlabel )) +
scale_x_continuous(limits = c(1,12), breaks = seq(1,12,by=1)) +
#Vertical line at temperature breaks
#geom_vline(xintercept=c(15,18)) +
theme(text = element_text(size=18), legend.text=element_text(size=16))
ggplot(data=dfTestElevBar) +  #[order(dfTestElevBar$TempCategory, decreasing = T),]
#Range of elevation for specified water temperature
geom_bar(aes(x=Month.x, y=ElevationAdd, fill=TempCategory, group = TempCategory), stat = "identity") +
#geom_ribbon(aes(x=Month.x, ymin= minElevation, ymax=maxElevation, fill=as.factor(Temperature))) +
scale_fill_manual(values = c("blue", "pink","red", "white"), breaks = cCategories) +
#scale_color_manual(values = c("blue","red")) +
labs(y="Water Surface Elevation (feet)", x="Month", fill="Turbine Release\nTemperature (oC)", linetype="", shape="") +
#labs(x="Temperature at Wahweap @ 3,490 ft (oC)", y="Turbine Release Temperature (oC)", color="") +
ylim(3370,3700) +
#scale_y_continuous(limits = c(3370,3700), breaks = seq(3250,3711, by=50),labels=seq(3250,3711, by=50),  sec.axis = sec_axis(~. +0, name = "Active Storage\n(million acre-feet)", breaks = dfPowellZonesMinusTop$level_feet, labels = dfPowellZonesMinusTop$rightlabel )) +
scale_x_continuous(limits = c(1,12), breaks = seq(1,12,by=1)) +
#Vertical line at temperature breaks
#geom_vline(xintercept=c(15,18)) +
theme(text = element_text(size=18), legend.text=element_text(size=16)) #
ggplot(data=dfTestElevBar) +  #[order(dfTestElevBar$TempCategory, decreasing = T),]
#Range of elevation for specified water temperature
geom_bar(aes(x=Month.x, y=ElevationAdd, fill=TempCategory, group = TempCategory), stat = "identity") +
#geom_ribbon(aes(x=Month.x, ymin= minElevation, ymax=maxElevation, fill=as.factor(Temperature))) +
scale_fill_manual(values = c("blue", "pink","red", "white"), breaks = cCategories) +
#scale_color_manual(values = c("blue","red")) +
labs(y="Water Surface Elevation (feet)", x="Month", fill="Turbine Release\nTemperature (oC)", linetype="", shape="") +
#labs(x="Temperature at Wahweap @ 3,490 ft (oC)", y="Turbine Release Temperature (oC)", color="") +
coord_cartesian(ylim = c(3370,3700)) +
#scale_y_continuous(limits = c(3370,3700), breaks = seq(3250,3711, by=50),labels=seq(3250,3711, by=50),  sec.axis = sec_axis(~. +0, name = "Active Storage\n(million acre-feet)", breaks = dfPowellZonesMinusTop$level_feet, labels = dfPowellZonesMinusTop$rightlabel )) +
scale_x_continuous(limits = c(1,12), breaks = seq(1,12,by=1)) +
#Vertical line at temperature breaks
#geom_vline(xintercept=c(15,18)) +
theme(text = element_text(size=18), legend.text=element_text(size=16)) #,
dfTestElevBar$Alpha <- ifelse(dfTestElevBar$TempCategory == cCategories[4],0,1)
ggplot(data=dfTestElevBar) +  #[order(dfTestElevBar$TempCategory, decreasing = T),]
#Range of elevation for specified water temperature
geom_bar(aes(x=Month.x, y=ElevationAdd, fill=TempCategory, group = TempCategory, alpha = Alpha), stat = "identity") +
#geom_ribbon(aes(x=Month.x, ymin= minElevation, ymax=maxElevation, fill=as.factor(Temperature))) +
scale_fill_manual(values = c("blue", "pink","red", "white"), breaks = cCategories) +
#scale_color_manual(values = c("blue","red")) +
labs(y="Water Surface Elevation (feet)", x="Month", fill="Turbine Release\nTemperature (oC)", linetype="", shape="") +
#labs(x="Temperature at Wahweap @ 3,490 ft (oC)", y="Turbine Release Temperature (oC)", color="") +
coord_cartesian(ylim = c(3370,3700)) +
#scale_y_continuous(limits = c(3370,3700), breaks = seq(3250,3711, by=50),labels=seq(3250,3711, by=50),  sec.axis = sec_axis(~. +0, name = "Active Storage\n(million acre-feet)", breaks = dfPowellZonesMinusTop$level_feet, labels = dfPowellZonesMinusTop$rightlabel )) +
scale_x_continuous(limits = c(1,12), breaks = seq(1,12,by=1)) +
#Vertical line at temperature breaks
#geom_vline(xintercept=c(15,18)) +
theme(text = element_text(size=18), legend.text=element_text(size=16))
ggplot(data=dfTestElevBar) +  #[order(dfTestElevBar$TempCategory, decreasing = T),]
#Range of elevation for specified water temperature
geom_bar(aes(x=Month.x, y=ElevationAdd, fill=TempCategory, group = TempCategory, alpha = Alpha), stat = "identity") +
#geom_ribbon(aes(x=Month.x, ymin= minElevation, ymax=maxElevation, fill=as.factor(Temperature))) +
scale_fill_manual(values = c("blue", "pink","red", "white"), breaks = cCategories) +
#scale_color_manual(values = c("blue","red")) +
labs(y="Water Surface Elevation (feet)", x="Month", fill="Turbine Release\nTemperature (oC)", alpha = "", linetype="", shape="") +
#labs(x="Temperature at Wahweap @ 3,490 ft (oC)", y="Turbine Release Temperature (oC)", color="") +
coord_cartesian(ylim = c(3370,3700)) +
scale_y_continuous(breaks = seq(3250,3711, by=50),labels=seq(3250,3711, by=50),  sec.axis = sec_axis(~. +0, name = "Active Storage\n(million acre-feet)", breaks = dfPowellZonesMinusTop$level_feet, labels = dfPowellZonesMinusTop$rightlabel )) +
scale_x_continuous(limits = c(1,12), breaks = seq(1,12,by=1)) +
#Vertical line at temperature breaks
#geom_vline(xintercept=c(15,18)) +
theme(text = element_text(size=18), legend.text=element_text(size=16))
ggplot(data=dfTestElevBar) +  #[order(dfTestElevBar$TempCategory, decreasing = T),]
#Range of elevation for specified water temperature
geom_bar(aes(x=Month.x, y=ElevationAdd, fill=TempCategory, group = TempCategory, alpha = Alpha), stat = "identity") +
#geom_ribbon(aes(x=Month.x, ymin= minElevation, ymax=maxElevation, fill=as.factor(Temperature))) +
scale_fill_manual(values = c("blue", "pink","red", "white"), breaks = cCategories) +
#scale_color_manual(values = c("blue","red")) +
labs(y="Water Surface Elevation (feet)", x="Month", fill="Turbine Release\nTemperature (oC)", alpha = "", linetype="", shape="") +
#labs(x="Temperature at Wahweap @ 3,490 ft (oC)", y="Turbine Release Temperature (oC)", color="") +
coord_cartesian(ylim = c(3370,3700)) +
scale_y_continuous(breaks = seq(3250,3711, by=50),labels=seq(3250,3711, by=50),  sec.axis = sec_axis(~. +0, name = "Active Storage\n(million acre-feet)", breaks = dfPowellZonesMinusTop$level_feet, labels = dfPowellZonesMinusTop$rightlabel )) +
scale_x_continuous(limits = c(1,12), breaks = seq(1,12,by=1)) +
scale_alpha(guide = 'none') +
#Vertical line at temperature breaks
#geom_vline(xintercept=c(15,18)) +
theme(text = element_text(size=18), legend.text=element_text(size=16))
ggplot(data=dfTestElev) +
#Range of elevation for specified water temperature
geom_errorbar(aes(x=Month.x, ymin= minElevation, ymax=maxElevation, color=as.factor(Temperature)), size=2, width=0.5) +
#geom_ribbon(aes(x=Month.x, ymin= minElevation, ymax=maxElevation, fill=as.factor(Temperature))) +
#scale_fill_manual(values = c("blue","red")) +
scale_color_manual(values = c("blue","red")) +
labs(y="Water Surface Elevation (feet)", x="Month", color="Turbine Release\nTemperature (oC)", linetype="", shape="") +
#labs(x="Temperature at Wahweap @ 3,490 ft (oC)", y="Turbine Release Temperature (oC)", color="") +
scale_y_continuous(limits = c(3370,3700), breaks = seq(3250,3711, by=50),labels=seq(3250,3711, by=50),  sec.axis = sec_axis(~. +0, name = "Active Storage\n(million acre-feet)", breaks = dfPowellZonesMinusTop$level_feet, labels = dfPowellZonesMinusTop$rightlabel )) +
scale_x_continuous(limits = c(1,12), breaks = seq(1,12,by=1)) +
#Vertical line at temperature breaks
#geom_vline(xintercept=c(15,18)) +
theme(text = element_text(size=18), legend.text=element_text(size=16)) #,
ggsave("ElevationRangesForTempTargetsErrorBars.png", width=9, height = 6.5, units="in")
ggplot(data=dfTestElevBar) +  #[order(dfTestElevBar$TempCategory, decreasing = T),]
#Range of elevation for specified water temperature
geom_bar(aes(x=Month.x, y=ElevationAdd, fill=TempCategory, group = TempCategory, alpha = Alpha), stat = "identity") +
#geom_ribbon(aes(x=Month.x, ymin= minElevation, ymax=maxElevation, fill=as.factor(Temperature))) +
scale_fill_manual(values = c("blue", "pink","red", "white"), breaks = cCategories) +
#scale_color_manual(values = c("blue","red")) +
labs(y="Water Surface Elevation (feet)", x="Month", fill="Turbine Release\nTemperature (oC)", alpha = "", linetype="", shape="") +
#labs(x="Temperature at Wahweap @ 3,490 ft (oC)", y="Turbine Release Temperature (oC)", color="") +
coord_cartesian(ylim = c(3370,3700)) +
scale_y_continuous(breaks = seq(3250,3711, by=50),labels=seq(3250,3711, by=50),  sec.axis = sec_axis(~. +0, name = "Active Storage\n(million acre-feet)", breaks = dfPowellZonesMinusTop$level_feet, labels = dfPowellZonesMinusTop$rightlabel )) +
scale_x_continuous(limits = c(1,12), breaks = seq(1,12,by=1)) +
scale_alpha(guide = 'none') +
#Vertical line at temperature breaks
#geom_vline(xintercept=c(15,18)) +
theme(text = element_text(size=18), legend.text=element_text(size=16)) #,
ggsave("ElevationRangesForTempTargetsStackedBars.png", width=9, height = 6.5, units="in")
ggplot(data=dfTestElevBar) +  #[order(dfTestElevBar$TempCategory, decreasing = T),]
#Range of elevation for specified water temperature
geom_bar(aes(x=Month.x, y=ElevationAdd, fill=TempCategory, group = TempCategory, alpha = Alpha), stat = "identity") +
#geom_ribbon(aes(x=Month.x, ymin= minElevation, ymax=maxElevation, fill=as.factor(Temperature))) +
scale_fill_manual(values = c("blue", "pink","red"), breaks = cCategories[1:3]) +
#scale_color_manual(values = c("blue","red")) +
labs(y="Water Surface Elevation (feet)", x="Month", fill="Turbine Release\nTemperature (oC)", alpha = "", linetype="", shape="") +
#labs(x="Temperature at Wahweap @ 3,490 ft (oC)", y="Turbine Release Temperature (oC)", color="") +
coord_cartesian(ylim = c(3370,3700)) +
scale_y_continuous(breaks = seq(3250,3711, by=50),labels=seq(3250,3711, by=50),  sec.axis = sec_axis(~. +0, name = "Active Storage\n(million acre-feet)", breaks = dfPowellZonesMinusTop$level_feet, labels = dfPowellZonesMinusTop$rightlabel )) +
scale_x_continuous(limits = c(1,12), breaks = seq(1,12,by=1)) +
scale_alpha(guide = 'none') +
#Vertical line at temperature breaks
#geom_vline(xintercept=c(15,18)) +
theme(text = element_text(size=18), legend.text=element_text(size=16)) #,
ggplot(data=dfTestElevBar) +  #[order(dfTestElevBar$TempCategory, decreasing = T),]
#Range of elevation for specified water temperature
geom_bar(aes(x=Month.x, y=ElevationAdd, fill=TempCategory, group = TempCategory, alpha = Alpha), stat = "identity") +
#geom_ribbon(aes(x=Month.x, ymin= minElevation, ymax=maxElevation, fill=as.factor(Temperature))) +
scale_fill_manual(values = c("blue", "pink","red","white"), breaks = cCategories[1:4], labels = cCategories[1:3]) +
#scale_color_manual(values = c("blue","red")) +
labs(y="Water Surface Elevation (feet)", x="Month", fill="Turbine Release\nTemperature (oC)", alpha = "", linetype="", shape="") +
#labs(x="Temperature at Wahweap @ 3,490 ft (oC)", y="Turbine Release Temperature (oC)", color="") +
coord_cartesian(ylim = c(3370,3700)) +
scale_y_continuous(breaks = seq(3250,3711, by=50),labels=seq(3250,3711, by=50),  sec.axis = sec_axis(~. +0, name = "Active Storage\n(million acre-feet)", breaks = dfPowellZonesMinusTop$level_feet, labels = dfPowellZonesMinusTop$rightlabel )) +
scale_x_continuous(limits = c(1,12), breaks = seq(1,12,by=1)) +
scale_alpha(guide = 'none') +
#Vertical line at temperature breaks
#geom_vline(xintercept=c(15,18)) +
theme(text = element_text(size=18), legend.text=element_text(size=16)) #
ggplot(data=dfTestElevBar) +  #[order(dfTestElevBar$TempCategory, decreasing = T),]
#Range of elevation for specified water temperature
geom_bar(aes(x=Month.x, y=ElevationAdd, fill=TempCategory, group = TempCategory, alpha = Alpha), stat = "identity") +
#geom_ribbon(aes(x=Month.x, ymin= minElevation, ymax=maxElevation, fill=as.factor(Temperature))) +
scale_fill_manual(values = c("blue", "pink","red","white"), breaks = cCategories[1:3], labels = cCategories[1:3]) +
#scale_color_manual(values = c("blue","red")) +
labs(y="Water Surface Elevation (feet)", x="Month", fill="Turbine Release\nTemperature (oC)", alpha = "", linetype="", shape="") +
#labs(x="Temperature at Wahweap @ 3,490 ft (oC)", y="Turbine Release Temperature (oC)", color="") +
coord_cartesian(ylim = c(3370,3700)) +
scale_y_continuous(breaks = seq(3250,3711, by=50),labels=seq(3250,3711, by=50),  sec.axis = sec_axis(~. +0, name = "Active Storage\n(million acre-feet)", breaks = dfPowellZonesMinusTop$level_feet, labels = dfPowellZonesMinusTop$rightlabel )) +
scale_x_continuous(limits = c(1,12), breaks = seq(1,12,by=1)) +
scale_alpha(guide = 'none') +
#Vertical line at temperature breaks
#geom_vline(xintercept=c(15,18)) +
theme(text = element_text(size=18), legend.text=element_text(size=16)) #,
