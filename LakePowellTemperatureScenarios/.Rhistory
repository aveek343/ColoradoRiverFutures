dfFishTempSuitPlot$Xplot <- paste(dfFishTempSuitPlot$GroupDescript, 1 - dfFishTempSuitPlot$Keystone,dfFishTempSuitPlot$`Common Name`,sep="-")
cNames <- dfFishTempSuitPlot %>% filter(LifeStage == "Growth") %>% select(`Common Name`)
cgNames <- dfFishTempSuitPlot %>% filter(LifeStage == "Growth") %>% select(Xplot)
# plot the suitability data
ggplot(dfFishTempSuitPlot) +
#Min-max range
geom_errorbar(aes(x = Xplot, ymin = Min., ymax = Max., color=GroupDescript, size = Keystone)) +
#Optimal as point
#geom_point(aes(x=Xplot,y=Opt., color=GroupDescript),size=4) +
facet_wrap( ~ LifeStage) +
scale_color_manual(values = c("blue","red","pink")) +
# scale_x_discrete(labels = dfFishTempSuitPlot %>% filter(LifeStage == "Growth") %>% select(`Common Name`)) +
scale_size_continuous(range = c(1,2), breaks = c(0,1), labels = c("Study", "Keystone")) +
scale_x_discrete(breaks = cgNames$Xplot, labels = cNames$`Common Name`) +
labs(x="Fish Species (common name)", y="River Temperature (oC)") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank(), axis.text.x = element_text(angle = 90, size=10, hjust=0.95,vjust=0.2))
ggsave("SpeciesTempNeeds.png", width=9, height = 6.5, units="in")
ggplot(dfFishTempSuitPlot %>% filter(LifeStage == "Growth")) +
#Min-max range
geom_errorbar(aes(x = Xplot, ymin = Min., ymax = Max., color=GroupDescript, size = Keystone)) +
#Optimal as point
#geom_point(aes(x=Xplot,y=Opt., color=GroupDescript),size=4) +
facet_wrap( ~ LifeStage) +
scale_color_manual(values = c("blue","red","pink")) +
# scale_x_discrete(labels = dfFishTempSuitPlot %>% filter(LifeStage == "Growth") %>% select(`Common Name`)) +
scale_size_continuous(range = c(1,2), breaks = c(0,1), labels = c("Study", "Keystone")) +
scale_x_discrete(breaks = cgNames$Xplot, labels = cNames$`Common Name`) +
labs(x="Fish Species (common name)", y="River Temperature (oC)") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank(), axis.text.x = element_text(angle = 90, size=10, hjust=0.95,vjust=0.2))
ggplot(dfFishTempSuitPlot) +
#Min-max range
geom_errorbar(aes(x = Xplot, ymin = Min., ymax = Max., color=GroupDescript, size = Keystone)) +
#Optimal as point
#geom_point(aes(x=Xplot,y=Opt., color=GroupDescript),size=4) +
#facet_wrap( ~ LifeStage) +
scale_color_manual(values = c("blue","red","pink")) +
# scale_x_discrete(labels = dfFishTempSuitPlot %>% filter(LifeStage == "Growth") %>% select(`Common Name`)) +
scale_size_continuous(range = c(1,2), breaks = c(0,1), labels = c("Study", "Keystone")) +
scale_x_discrete(breaks = cgNames$Xplot, labels = cNames$`Common Name`) +
labs(x="Fish Species (common name)", y="River Temperature (oC)") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank(), axis.text.x = element_text(angle = 90, size=10, hjust=0.95,vjust=0.2))
ggplot(dfFishTempSuitPlot) +
#Min-max range
geom_errorbar(aes(x = Xplot, ymin = Min., ymax = Max., color=GroupDescript, size = Keystone)) +
#Optimal as point
#geom_point(aes(x=Xplot,y=Opt., color=GroupDescript),size=4) +
#facet_wrap( ~ LifeStage) +
scale_color_manual(values = c("blue","red","pink")) +
# scale_x_discrete(labels = dfFishTempSuitPlot %>% filter(LifeStage == "Growth") %>% select(`Common Name`)) +
scale_size_continuous(range = c(1,2), breaks = c(0,1), labels = c("Study", "Keystone")) +
scale_x_discrete(breaks = cgNames$Xplot, labels = cNames$`Common Name`) +
labs(x="Fish Species (common name)", y="River Temperature (oC)") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank(), axis.text.x = element_text(angle = 90, size=14, hjust=0.95,vjust=0.2))
rm(list = ls())  #Clear history
# Load required libraies
if (!require(tidyverse)) {
install.packages("tidyverse", repos="http://cran.r-project.org")
library(tidyverse)
}
if (!require(readxl)) {
install.packages("readxl", repos="http://cran.r-project.org")
library(readxl)
}
if (!require(RColorBrewer)) {
install.packages("RColorBrewer",repos="http://cran.r-project.org")
library(RColorBrewer) #
}
if (!require(dplyr)) {
install.packages("dplyr",repos="http://cran.r-project.org")
library(dplyr) #
}
if (!require(expss)) {
install.packages("expss",repos="http://cran.r-project.org")
library(expss) #
}
if (!require(reshape)) {
install.packages("reshape", repos="http://cran.r-project.org")
library(reshape)
}
if (!require(reshape2)) {
install.packages("reshape2", repos="http://cran.r-project.org")
library(reshape2)
}
if (!require(pracma)) {
install.packages("pracma", repos="http://cran.r-project.org")
library(pracma)
}
if (!require(lubridate)) {
install.packages("lubridate", repos="http://cran.r-project.org")
library(lubridate)
}
if (!require(directlabels)) {
install.packages("directlabels", repo="http://cran.r-project.org")
library(directlabels)
}
#if (!require(plyr)) {
#  install.packages("plyr", repo="http://cran.r-project.org")
#  library(plyr)
#}
if (!require(ggrepel)) {
devtools::install_github("slowkow/ggrepel")
library(ggrepel)
}
library(dygraphs)
library(xts)          # To make the convertion data-frame / xts format
library(tidyverse)
library(lubridate)
### 0. Definitions
dMetersToFeet = 3.28
sStation = 'LPCR0024' #Wahweap
sMonth = 'Jun' #Month
# New function interpNA to return NAs for values outside interpolation range (from https://stackoverflow.com/questions/47295879/using-interp1-in-r)
interpNA <- function(x, y, xi = x, ...) {
yi <- rep(NA, length(xi));
sel <- which(xi >= range(x)[1] & xi <= range(x)[2]);
yi[sel] <- interp1(x = x, y = y, xi = xi[sel], ...);
return(yi);
}
### 1. Read IN the data files
# Temperature profile data
sPowellTempProfileFile <- 'qryProfiles at Primary Stations.csv'
# Read in the historical Powell data
dfPowellTempProfiles <- read.csv(file=sPowellTempProfileFile,
header=TRUE,
stringsAsFactors=FALSE,
sep=",")
# This historical reservoir level data comes from USBR website.
# File name to read in historical Powell Volume from CSV (download from USBR)
#    Water Operations: Historic Data, Upper Colorado River Division, U.S. Buruea of Reclamation
#    https://www.usbr.gov/rsvrWater/HistoricalApp.html
sPowellHistoricalFile <- 'LAKEPOWELL06-16-2020T16.32.29.csv'
# Read in the historical Powell data
dfPowellHistorical <- read.csv(file=sPowellHistoricalFile,
header=TRUE,
stringsAsFactors=FALSE,
sep=",")
# Read in Lake Powell Release Temperature Data (provided by Bryce M.)
sPowellReleaseTempFile <- 'GCD_release_water_temp.csv'
# Read in the historical Powell data
dfPowellReleaseTemp <- read.csv(file=sPowellReleaseTempFile,
header=TRUE,
stringsAsFactors=FALSE,
sep=",")
library(chron)
#Convert just the date
dfPowellReleaseTemp$DateClean <- as.Date(dfPowellReleaseTemp$DateTime, "%m/%d/%Y")
#Convert the time
#dfPowellReleaseTemp$DateTimeClean <- as.POSIXct(dfPowellReleaseTemp$DateTime, format="%m/%d/%Y %H:%M:%S")
dfPowellReleaseTemp$DateTimeClean <- mdy_hms(dfPowellReleaseTemp$DateTime)
###This reservoir data comes from CRSS. It was exported to Excel.
# Read pool level data in from Excel
sExcelFile <- 'PowellZones.xlsx'
sStation <- 'LPCR0024'   #Closest to Dam
# Read in the historical Mead data
dfPowellZones <- read_excel(sExcelFile)
# Load in the fish temperature suitability data from Excel/Valdez et al (2013)
sTempSuitFile <- 'FishTemperatureRequirements.xlsx'
dfFishTempSuit <- read_excel(sTempSuitFile, sheet = 2, col_names=TRUE)
dfMinDegreeDays <- read_excel(sTempSuitFile, sheet = 3, col_names=TRUE)
# Melt to move life stage into a new category
dfFishTempSuitMelt <- melt(dfFishTempSuit, id.vars= c("Common Name", "Group", "GroupDescript", "Code", "Keystone"))
#Split variable into species life stage and measurement
lTemp <- (as.data.frame(matrix(unlist(str_split(dfFishTempSuitMelt$variable, pattern="-")),ncol=2,byrow=TRUE)))
colnames(lTemp) <- c("LifeStage","Var")
lTemp$Row <- 1:nrow(lTemp)
dfFishTempSuitMelt$Row <- 1:nrow(dfFishTempSuitMelt)
# Join the split strings back in
dfFishTempSuitMelt <- inner_join(dfFishTempSuitMelt,lTemp,by = c("Row" = "Row"))
# Cast to separate out vars
dfFishTempSuitPlot <- dcast(dfFishTempSuitMelt, `Common Name` + GroupDescript + LifeStage + Keystone ~ Var)
dfFishTempSuitPlot$LifeStage <- as.character(dfFishTempSuitPlot$LifeStage)
#Reorder by the gouping in the plot => Temp group, Keystone, Common Name
dfFishTempSuitPlot <- dfFishTempSuitPlot[order(dfFishTempSuitPlot$GroupDescript,-dfFishTempSuitPlot$Keystone,dfFishTempSuitPlot$`Common Name`),]
dfFishTempSuitPlot$Xplot <- paste(dfFishTempSuitPlot$GroupDescript, 1 - dfFishTempSuitPlot$Keystone,dfFishTempSuitPlot$`Common Name`,sep="-")
cNames <- dfFishTempSuitPlot %>% filter(LifeStage == "Growth") %>% select(`Common Name`)
cgNames <- dfFishTempSuitPlot %>% filter(LifeStage == "Growth") %>% select(Xplot)
# plot the suitability data
ggplot(dfFishTempSuitPlot) +
#Min-max range
geom_errorbar(aes(x = Xplot, ymin = Min., ymax = Max., color=GroupDescript, size = Keystone)) +
#Optimal as point
#geom_point(aes(x=Xplot,y=Opt., color=GroupDescript),size=4) +
facet_wrap( ~ LifeStage) +
scale_color_manual(values = c("blue","red","pink")) +
# scale_x_discrete(labels = dfFishTempSuitPlot %>% filter(LifeStage == "Growth") %>% select(`Common Name`)) +
scale_size_continuous(range = c(1,2), breaks = c(0,1), labels = c("Study", "Keystone")) +
scale_x_discrete(breaks = cgNames$Xplot, labels = cNames$`Common Name`) +
labs(x="Fish Species (common name)", y="River Temperature (oC)") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank(), axis.text.x = element_text(angle = 90, size=10, hjust=0.95,vjust=0.2))
ggplot(dfFishTempSuitPlot) +
#Min-max range
geom_errorbar(aes(x = Xplot, ymin = Min., ymax = Max., color=GroupDescript, size = Keystone)) +
#Optimal as point
#geom_point(aes(x=Xplot,y=Opt., color=GroupDescript),size=4) +
#facet_wrap( ~ LifeStage) +
scale_color_manual(values = c("blue","red","pink")) +
# scale_x_discrete(labels = dfFishTempSuitPlot %>% filter(LifeStage == "Growth") %>% select(`Common Name`)) +
scale_size_continuous(range = c(1,2), breaks = c(0,1), labels = c("Study", "Keystone")) +
scale_x_discrete(breaks = cgNames$Xplot, labels = cNames$`Common Name`) +
labs(x="Fish Species (common name)", y="River Temperature (oC)") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank(), axis.text.x = element_text(angle = 90, size=14, hjust=0.95,vjust=0.2))
ggsave("SpeciesTempNeedsCombined.png", width=9, height = 6.5, units="in")
dfPowellReleaseTempSum <- dfPowellReleaseTemp %>% group_by(DateClean) %>% summarize(minDay = min(WaterTemp_C),
maxDay = max(WaterTemp_C),
avgDay = mean(WaterTemp_C),
rangeDay = max(WaterTemp_C) - min(WaterTemp_C))
#Pull out Year, Month, Month as abbr, Day for plotting
dfPowellReleaseTempSum$Year <- year(dfPowellReleaseTempSum$DateClean)
dfPowellReleaseTempSum$Month <- month(dfPowellReleaseTempSum$DateClean)
dfPowellReleaseTempSum$MonthTxt <- format(dfPowellReleaseTempSum$DateClean, "%b")
dfPowellReleaseTempSum$Day <- day(dfPowellReleaseTempSum$DateClean)
dfPowellReleaseTempSum$WaterYear <- ifelse(dfPowellReleaseTempSum$Month >= 10,dfPowellReleaseTempSum$Year, dfPowellReleaseTempSum$Year - 1 )
dfPowellReleaseTempSum$DayOfYear <- yday(dfPowellReleaseTempSum$DateClean)
dfDaysPerYear <- dfPowellReleaseTempSum %>% group_by(Year) %>% summarize(numDays = n())
dfDaysPerMonthYear <- dfPowellReleaseTempSum %>% group_by(Year,Month) %>% summarize(numDays = n())
palBlues <- brewer.pal(9, "Blues")
palReds <- brewer.pal(9, "Reds")
palBlueFunc <- colorRampPalette(c(palBlues[3],palBlues[9]))
## Plot histograms of the daily range for each month
ggplot(dfPowellReleaseTempSum, aes(x=rangeDay)) +
geom_histogram(color="darkmagenta", fill="magenta", binwidth = 0.2) +
#scale_x_continuous(limits = c(2,22), breaks = seq(2,22,by=2)) +
#scale_y_continuous(breaks = seq(0,11,by=2)) +
facet_wrap(~ MonthTxt) +
labs(x="Daily Range of Powell Release Temperature (oC)", y="Frequency\n(number of days)") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
ggsave("PowellReleaseTempRangeByMonth.png", width=9, height = 6.5, units="in")
## Plot cumulative distribution of the daily range for each month
pPlot <- ggplot(dfPowellReleaseTempSum, aes(rangeDay, group=Month, color=MonthTxt)) +
stat_ecdf(geom = "step") +
#scale_x_continuous(limits = c(2,22), breaks = seq(2,22,by=2)) +
#scale_y_continuous(breaks = seq(0,11,by=2)) +
scale_color_manual(values = palBlueFunc(12)) +
xlim(0,2) +
#facet_wrap( ~ Year ) +
labs(x="Daily Range of Powell Release Temperature (oC)", y="Cumulative Frequency\n(number of days)", color = "Month") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
direct.label(pPlot, "angled.boxes" )
ggsave("PowellReleaseTempRangeByMonthCDF.png", width=9, height = 6.5, units="in")
## Plot cumulative distribution of the daily range for each year
pPlot <- ggplot(dfPowellReleaseTempSum %>% filter(WaterYear < 2018), aes(rangeDay, group=WaterYear, color=WaterYear)) +
stat_ecdf(geom = "step") +
#scale_x_continuous(limits = c(2,22), breaks = seq(2,22,by=2)) +
#scale_y_continuous(breaks = seq(0,11,by=2)) +
scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color", name="Water Year") +
xlim(0,2) +
#facet_wrap( ~ Month ) +
labs(x="Daily Range of Powell Release Temperature (oC)", y="Cumulative Frequency\n(number of days)", color = "Water Year") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
direct.label(pPlot, "angled.boxes" )
ggsave("PowellReleaseTempRangeByYearCDF.png", width=9, height = 6.5, units="in")
## Plot cumulative distribution of the daily range for each month and year
ggplot(dfPowellReleaseTempSum %>% filter(Year > 1988), aes(rangeDay, group=WaterYear, color=WaterYear)) +
stat_ecdf(geom = "step") +
xlim(0,2) +
facet_wrap( ~ Month ) +
scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color", name="Year") +
labs(x="Daily Range of Powell Release Temperature (oC)", y="Cumulative Frequency\n(number of days)", color = "Year") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
ggsave("PowellReleaseTempRangeByMonthYearCDF.png", width=9, height = 6.5, units="in")
ggplot(dfPowellReleaseTempSum, aes(x = DayOfYear, y= avgDay, group=Year, color=Year)) +
geom_line() +
# scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color", name="Year") +
labs(x="Julian Day", y="Avg. Daily Release Temperature (oC)", color = "Year") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
ggsave("DailyReleaseBy.png", width=9, height = 6.5, units="in")
sCOCiscoFile <- 'ColoradoRiverCisco.xlsx'
dfCisco <- read_excel(file=sCOCiscoFile,
header=TRUE,
range = "A37:H39077")
dfCisco <- read_excel(file=sCOCiscoFile)
dfCisco <- read_excel(sCOCiscoFile)
dfCisco <- read_excel(sCOCiscoFile,
header=TRUE,
range = "A37:H39077")
dfCisco <- read_excel(sCOCiscoFile, col_names=TRUE, range = "A37:H39077")
View(dfCisco)
dfCisco$Date <- as.Date(dfCisco$Date)
dfCisco$Year <- year(dfCisco$Date)
dfCisco$DayOfYear <- ydate(dfCisco$Date)
dfCisco$DayOfYear <- yday(dfCisco$Date)
dfCisco <- read_excel(sCOCiscoFile, col_names=FALSE, range = "A33969:H39077")
colnames(dfCisco) <- c("Org", "Gage", "Date", "Flow (csf)", "Mean Temperature (oC)", "Max Temperature (oC)",	"Min Temperature (oC)")
colnames(dfCisco) <- c("Org", "Gage", "Date", "Flow (csf)", "Accuracy", "Mean Temperature (oC)", "Max Temperature (oC)",	"Min Temperature (oC)")
dfCisco$TempRange <- dfCisco$`Max Temperature (oC)` - dfCisco$`Min Temperature (oC)`
colnames(dfCisco) <- c("Org", "Gage", "Date", "Flow (cfs)", "Accuracy", "Mean Temperature (oC)", "Max Temperature (oC)",	"Min Temperature (oC)")
ggplot(dfPowellReleaseTempSum, aes(x = DayOfYear, y= `Flow (cfs)`, group=Year, color=Year)) +
geom_line() +
# scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color", name="Year") +
labs(x="Julian Day", y="Avg. Daily Release Temperature (oC)", color = "Year") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
colnames(dfCisco) <- c("Org", "Gage", "Date", "Flow(cfs)", "Accuracy", "Mean Temperature (oC)", "Max Temperature (oC)",	"Min Temperature (oC)")
ggplot(dfCisco, aes(x = DayOfYear, y= `Flow(cfs)`, group=Year, color=Year)) +
geom_line() +
# scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color", name="Year") +
labs(x="Julian Day", y="Avg. Daily Release Temperature (oC)", color = "Year") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
dfCisco <- read_excel(sCOCiscoFile, col_names=FALSE, range = "A33969:H39077")
#Rename the columns
colnames(dfCisco) <- c("Org", "Gage", "Date", "Flow(cfs)", "Accuracy", "Mean Temperature (oC)", "Max Temperature (oC)",	"Min Temperature (oC)")
#Convert to date
dfCisco$Date <- as.Date(dfCisco$Date)
dfCisco$Year <- year(dfCisco$Date)
dfCisco$DayOfYear <- yday(dfCisco$Date)
dfCisco$TempRange <- dfCisco$`Max Temperature (oC)` - dfCisco$`Min Temperature (oC)`
#Plot
ggplot(dfCisco, aes(x = DayOfYear, y= `Flow(cfs)`, group=Year, color=Year)) +
geom_line() +
# scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color", name="Year") +
labs(x="Julian Day", y="Avg. Daily Release Temperature (oC)", color = "Year") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
ggplot(dfCisco, aes(x = DayOfYear, y= `Mean Temperature (oC)`, group=Year, color=Year)) +
geom_line() +
# scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color", name="Year") +
labs(x="Julian Day", y="Avg. Daily Release Temperature (oC)", color = "Year") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
dfCisco <- read_excel(sCOCiscoFile, col_names=FALSE, range = "A33969:H39061")
#Rename the columns
colnames(dfCisco) <- c("Org", "Gage", "Date", "Flow(cfs)", "Accuracy", "Mean Temperature (oC)", "Max Temperature (oC)",	"Min Temperature (oC)")
#Convert to date
dfCisco$Date <- as.Date(dfCisco$Date)
dfCisco$Year <- year(dfCisco$Date)
dfCisco$DayOfYear <- yday(dfCisco$Date)
dfCisco$TempRange <- dfCisco$`Max Temperature (oC)` - dfCisco$`Min Temperature (oC)`
#Plot
ggplot(dfCisco, aes(x = DayOfYear, y= `Mean Temperature (oC)`, group=Year, color=Year)) +
geom_line() +
# scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color", name="Year") +
labs(x="Julian Day", y="Avg. Daily Release Temperature (oC)", color = "Year") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
ggplot(dfCisco %>% filter(`Mean Temperature (oC)` < 100), aes(x = DayOfYear, y= `Mean Temperature (oC)`, group=Year, color=Year)) +
geom_line() +
# scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color", name="Year") +
labs(x="Julian Day", y="Avg. Daily Release Temperature (oC)", color = "Year") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
ggplot(dfCisco %>% filter(`Mean Temperature (oC)` < 100), aes(x = DayOfYear, y= `Mean Temperature (oC)`, group=Year, color=Year)) +
geom_line() +
# scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color", name="Year") +
labs(x="Julian Day", y="Avg. Daily Temperature at Cisco (oC)", color = "Year") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
ggplot(dfPowellReleaseTempSum, aes(x = DayOfYear, y= avgDay, group=Year, color=Year)) +
geom_line() +
#Overplot temperature at Cisco in thick black
geom_line(dfCisco %>% filter(`Mean Temperature (oC)` < 100,Year==2018), aes(x = DayOfYear, y= `Mean Temperature (oC)`), color="Black",linewidth=2) +
# scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color", name="Year") +
labs(x="Julian Day", y="Avg. Daily Release Temperature (oC)", color = "Year") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
ggplot(dfPowellReleaseTempSum, aes(x = DayOfYear, y= avgDay, group=Year, color=Year)) +
geom_line() +
#Overplot temperature at Cisco in thick black
geom_line(dfCisco %>% filter(`Mean Temperature (oC)`< 100,Year==2018), aes(x = DayOfYear, y= `Mean Temperature (oC)`, color="Black",linewidth=2)) +
# scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color", name="Year") +
labs(x="Julian Day", y="Avg. Daily Release Temperature (oC)", color = "Year") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
ggplot(dfCisco %>% filter(`Mean Temperature (oC)` < 100, year==2018), aes(x = DayOfYear, y= `Mean Temperature (oC)`, group=Year, color=Year)) +
geom_line() +
# scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color", name="Year") +
labs(x="Julian Day", y="Avg. Daily Temperature at Cisco (oC)", color = "Year") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
ggplot(dfCisco %>% filter(`Mean Temperature (oC)` < 100, Year==2018), aes(x = DayOfYear, y= `Mean Temperature (oC)`, group=Year, color=Year)) +
geom_line() +
# scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color", name="Year") +
labs(x="Julian Day", y="Avg. Daily Temperature at Cisco (oC)", color = "Year") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
ggplot(dfPowellReleaseTempSum, aes(x = DayOfYear, y= avgDay, group=Year, color=Year)) +
geom_line() +
#Overplot temperature at Cisco in thick black
geom_line(dfCisco %>% filter(`Mean Temperature (oC)`< 100,Year==2018), aes(x = DayOfYear, y= `Mean Temperature (oC)`, color="Black",linewidth=2))
ggplot(dfPowellReleaseTempSum, aes(x = DayOfYear, y= avgDay, group=Year, color=Year)) +
geom_line() +
#Overplot temperature at Cisco in thick black
geom_line(data = dfCisco %>% filter(`Mean Temperature (oC)`< 100,Year==2018), aes(x = DayOfYear, y= `Mean Temperature (oC)`, color="Black",linewidth=2)) +
# scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color", name="Year") +
labs(x="Julian Day", y="Avg. Daily Release Temperature (oC)", color = "Year") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
ggplot(dfPowellReleaseTempSum, aes(x = DayOfYear, y= avgDay, group=Year, color=Year)) +
geom_line() +
#Overplot temperature at Cisco in thick black
geom_line(data = dfCisco %>% filter(`Mean Temperature (oC)`< 100,Year==2018), aes(x = DayOfYear, y= `Mean Temperature (oC)`), size=2) +
# scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color", name="Year") +
labs(x="Julian Day", y="Avg. Daily Release Temperature (oC)", color = "Year") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
ggplot(dfPowellReleaseTempSum, aes(x = DayOfYear, y= avgDay, group=Year, color="red")) +
geom_line() +
#Overplot temperature at Cisco in thick black
geom_line(data = dfCisco %>% filter(`Mean Temperature (oC)`< 100), aes(x = DayOfYear, y= `Mean Temperature (oC)`, group="Year",color="Blue"), size=1.5) +
# scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color", name="Year") +
labs(x="Julian Day", y="Water Temperature (oC)", color = "Location") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
ggplot(dfPowellReleaseTempSum, aes(x = DayOfYear, y= avgDay, group=Year, color="Powell Release")) +
geom_line() +
#Overplot temperature at Cisco in thick black
geom_line(data = dfCisco %>% filter(`Mean Temperature (oC)`< 100), aes(x = DayOfYear, y= `Mean Temperature (oC)`, group="Year",color="Cisco")) +
scale_color_manual(values = c("Red","Blue")) +
# scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color", name="Year") +
labs(x="Julian Day", y="Water Temperature (oC)", color = "Location") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
ggplot(dfPowellReleaseTempSum, aes(x = DayOfYear, y= avgDay, group=Year, color="Powell Release")) +
geom_line() +
#Overplot temperature at Cisco in thick black
geom_line(data = dfCisco %>% filter(`Mean Temperature (oC)`< 100), aes(x = DayOfYear, y= `Mean Temperature (oC)`, group="Year",color="Cisco")) +
#Add fish temperature threshold
geom_hline(yintercept=14, color="Fish Threshold") +
scale_color_manual(values = c("Red","Black","Blue")) +
# scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color", name="Year") +
labs(x="Julian Day", y="Water Temperature (oC)", color = "Location") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
ggplot(dfPowellReleaseTempSum, aes(x = DayOfYear, y= avgDay, group=Year, color="Powell Release")) +
geom_line() +
#Overplot temperature at Cisco in thick black
geom_line(data = dfCisco %>% filter(`Mean Temperature (oC)`< 100), aes(x = DayOfYear, y= `Mean Temperature (oC)`, group="Year",color="Cisco")) +
#Add fish temperature threshold
geom_hline(yintercept=14, aes(color="Fish Threshold")) +
scale_color_manual(values = c("Red","Black","Blue")) +
# scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color", name="Year") +
labs(x="Julian Day", y="Water Temperature (oC)", color = "Location") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
ggplot(dfPowellReleaseTempSum, aes(x = DayOfYear, y= avgDay, group=Year, color="Powell Release")) +
geom_line() +
#Overplot temperature at Cisco in thick black
geom_line(data = dfCisco %>% filter(`Mean Temperature (oC)`< 100), aes(x = DayOfYear, y= `Mean Temperature (oC)`, group="Year",color="Cisco")) +
#Add fish temperature threshold
geom_hline(yintercept=14, aes(color="Fish Threshold", size=2, linestyle="dashed")) +
scale_color_manual(values = c("Red","Black","Blue")) +
# scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color", name="Year") +
labs(x="Julian Day", y="Water Temperature (oC)", color = "Location") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
ggplot(dfPowellReleaseTempSum, aes(x = DayOfYear, y= avgDay, group=Year, color="Powell Release")) +
geom_line() +
#Overplot temperature at Cisco in thick black
geom_line(data = dfCisco %>% filter(`Mean Temperature (oC)`< 100), aes(x = DayOfYear, y= `Mean Temperature (oC)`, group="Year",color="Cisco")) +
#Add fish temperature threshold
geom_hline(yintercept=14, aes(color="Fish Threshold", size=2, linestyle="dashed")) +
scale_color_manual(values = c("Red","Black","Blue", breaks=c("Cisco","Powell Release","Fish Threshold"))) +
# scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color", name="Year") +
labs(x="Julian Day", y="Water Temperature (oC)", color = "Location") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
ggplot(dfPowellReleaseTempSum, aes(x = DayOfYear, y= avgDay, group=Year, color="Powell Release")) +
geom_line() +
#Overplot temperature at Cisco in thick black
geom_line(data = dfCisco %>% filter(`Mean Temperature (oC)`< 100), aes(x = DayOfYear, y= `Mean Temperature (oC)`, group="Year",color="Cisco")) +
#Add fish temperature threshold
geom_hline(yintercept=14, aes(color="Fish Threshold"), size=2, linestyle="dashed") +
scale_color_manual(values = c("Red","Black","Blue", breaks=c("Cisco","Powell Release","Fish Threshold"))) +
# scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color", name="Year") +
labs(x="Julian Day", y="Water Temperature (oC)", color = "Location") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
ggplot(dfPowellReleaseTempSum, aes(x = DayOfYear, y= avgDay, group=Year, color="Powell Release")) +
geom_line() +
#Overplot temperature at Cisco in thick black
geom_line(data = dfCisco %>% filter(`Mean Temperature (oC)`< 100), aes(x = DayOfYear, y= `Mean Temperature (oC)`, group="Year",color="Cisco")) +
#Add fish temperature threshold
geom_hline(yintercept=14, color="Fish Threshold", size=2, linestyle="dashed") +
scale_color_manual(values = c("Red","Black","Blue", breaks=c("Cisco","Powell Release","Fish Threshold"))) +
# scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color", name="Year") +
labs(x="Julian Day", y="Water Temperature (oC)", color = "Location") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
ggplot(dfPowellReleaseTempSum, aes(x = DayOfYear, y= avgDay, group=Year, color="Powell Release")) +
geom_line() +
#Overplot temperature at Cisco in thick black
geom_line(data = dfCisco %>% filter(`Mean Temperature (oC)`< 100), aes(x = DayOfYear, y= `Mean Temperature (oC)`, group="Year",color="Cisco")) +
#Add fish temperature threshold
geom_hline(yintercept=14, aes(color="Fish Threshold"), size=2, linestyle="longdash") +
scale_color_manual(values = c("Red","Black","Blue", breaks=c("Cisco","Powell Release","Fish Threshold"))) +
# scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color", name="Year") +
labs(x="Julian Day", y="Water Temperature (oC)", color = "Location") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
ggplot(dfPowellReleaseTempSum, aes(x = DayOfYear, y= avgDay, group=Year, color="Powell Release")) +
geom_line() +
#Overplot temperature at Cisco in thick black
geom_line(data = dfCisco %>% filter(`Mean Temperature (oC)`< 100), aes(x = DayOfYear, y= `Mean Temperature (oC)`, group="Year",color="Cisco")) +
#Add fish temperature threshold
geom_hline(yintercept=14, color="black", size=2, linestyle="longdash") +
scale_color_manual(values = c("Red","Black","Blue", breaks=c("Cisco","Powell Release","Fish Threshold"))) +
# scale_color_continuous(low=palBlues[3],high=palBlues[9], na.value="White", guide = "colorbar", aesthetics="color", name="Year") +
labs(x="Julian Day", y="Water Temperature (oC)", color = "Location") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
legend.key = element_blank())
ggsave("CiscoReleaseFishThreshold.png", width=9, height = 6.5, units="in")
