#Error bar
#geom_errorbar(data=dfCombineEvap, aes(x=CombLiveStor/1000000,ymin=EvapVolMaxLoComb/1000000, ymax=EvapVolMaxUpComb/1000000), width=.2,
#             position=position_dodge(0.2)) +
geom_line(data=dfPartitionResults,aes(x=TotalStorage,y=CombEvap/1000000, color = PercentInMead*100, group=PercentInMead), size=2) +
#Show the difference between the two
geom_text(data=dfEvapDiff, aes(x=TotalStorage,y=MaxEvap/1e6+0.1,label=round(Diff/1e6,2)), size=5, color="red") +
#Label the top and bottom lines
geom_text(data=dfPartitionResults,aes(x=20,y=0.75,label="All in Mead"),size=6) +
geom_text(data=dfPartitionResults,aes(x=15,y=1.05,label="All in Powell"),size=6) +
geom_text(data=dfPartitionResults,aes(x=42.5,y=1.5,label="Difference between\nAll in Mead and\nAll in Powell\n(MAF per year)"),size=6, color="red") +
#geom_step(data=dfCutbacks,aes(x=2*MeadActiveVolume/1000000,y=Total2007ISG/1000000, color = "ISG", linetype="ISG"), size=2, direction="vh") +
#geom_step(data=dfCutbacks,aes(x=2*MeadActiveVolume/1000000,y=TotalDCP/1000000, color = "DCP", linetype="DCP"), size=2, direction="vh") +
#scale_color_manual(name="Guide1",values = c("Blue", "Black", "Red"),breaks=c("DCP", "ISG", "Evaporation"), labels= c("Drought Contingency Plan (2019) Cutbacks", "Interim Shortage Guidelines (2008) Cutbacks", paste("Evaporation",strEvapRangeComb))) +
#scale_linetype_manual(name="Guide1",values=c("Evaporation"="twodash","DCP"="solid","ISG"="longdash"), breaks=c("DCP", "ISG", "Evaporation"), labels= c("Drought Contingency Plan (2019) Cutbacks", "Interim Shortage Guidelines (2008) Cutbacks", paste("Evaporation",strEvapRangeComb))) +
#Continuous color scale by Mead Percent
scale_color_continuous(name="Storage in Mead (%)", low=palBlues[1],high=palBlues[9], na.value="White", aesthetics="color") +
#scale_color_continuous(low=palBlues[1],high=palBlues[9], na.value="White", aesthetics="color") +
scale_x_continuous(breaks = cCombScale,labels=cCombScale, limits = c(0,2*as.numeric(dfMaxStor %>% filter(Reservoir %in% c("Mead")) %>% select(Volume))),
sec.axis = sec_axis(~. +0, breaks = 2*dfMeadPoolsPlot$stor_maf, labels = dfMeadPoolsPlot$labelComb)) +
guides(color=guide_legend(keywidth = 3, keyheight = 1)) +
theme_bw() +
#coord_fixed() +
labs(x="Mead + Powell Active Storage (MAF)", y="Evaporated Volume (MAF per year)") +
theme(text = element_text(size=20), legend.text=element_text(size=18), legend.position = c(0.15,0.8))
ggplot() +
#Error bar
#geom_errorbar(data=dfCombineEvap, aes(x=CombLiveStor/1000000,ymin=EvapVolMaxLoComb/1000000, ymax=EvapVolMaxUpComb/1000000), width=.2,
#             position=position_dodge(0.2)) +
geom_line(data=dfPartitionResults,aes(x=TotalStorage,y=CombEvap/1000000, color = PercentInMead*100, group=PercentInMead), size=2) +
#Show the difference between the two
geom_text(data=dfEvapDiff, aes(x=TotalStorage,y=MaxEvap/1e6+0.1,label=round(Diff/1e6,2)), size=5, color="red") +
#Label the top and bottom lines
geom_text(data=dfPartitionResults,aes(x=20,y=0.75,label="All in Mead"),size=6) +
geom_text(data=dfPartitionResults,aes(x=15,y=1.05,label="All in Powell"),size=6) +
geom_text(data=dfPartitionResults,aes(x=42.5,y=1.25,label="Difference between\nAll in Mead and\nAll in Powell\n(MAF per year)"),size=5, color="red") +
#geom_step(data=dfCutbacks,aes(x=2*MeadActiveVolume/1000000,y=Total2007ISG/1000000, color = "ISG", linetype="ISG"), size=2, direction="vh") +
#geom_step(data=dfCutbacks,aes(x=2*MeadActiveVolume/1000000,y=TotalDCP/1000000, color = "DCP", linetype="DCP"), size=2, direction="vh") +
#scale_color_manual(name="Guide1",values = c("Blue", "Black", "Red"),breaks=c("DCP", "ISG", "Evaporation"), labels= c("Drought Contingency Plan (2019) Cutbacks", "Interim Shortage Guidelines (2008) Cutbacks", paste("Evaporation",strEvapRangeComb))) +
#scale_linetype_manual(name="Guide1",values=c("Evaporation"="twodash","DCP"="solid","ISG"="longdash"), breaks=c("DCP", "ISG", "Evaporation"), labels= c("Drought Contingency Plan (2019) Cutbacks", "Interim Shortage Guidelines (2008) Cutbacks", paste("Evaporation",strEvapRangeComb))) +
#Continuous color scale by Mead Percent
scale_color_continuous(name="Storage in Mead (%)", low=palBlues[1],high=palBlues[9], na.value="White", aesthetics="color") +
#scale_color_continuous(low=palBlues[1],high=palBlues[9], na.value="White", aesthetics="color") +
scale_x_continuous(breaks = cCombScale,labels=cCombScale, limits = c(0,2*as.numeric(dfMaxStor %>% filter(Reservoir %in% c("Mead")) %>% select(Volume))),
sec.axis = sec_axis(~. +0, breaks = 2*dfMeadPoolsPlot$stor_maf, labels = dfMeadPoolsPlot$labelComb)) +
guides(color=guide_legend(keywidth = 3, keyheight = 1)) +
theme_bw() +
#coord_fixed() +
labs(x="Mead + Powell Active Storage (MAF)", y="Evaporated Volume (MAF per year)") +
theme(text = element_text(size=20), legend.text=element_text(size=18), legend.position = c(0.15,0.8))
dfEvapDiffMelt <- melt(dfEvapDiff[, c("TotalStorage","MinEvap","MaxEvap")], id = c("TotalStorage"))
View(dfEvapDiffMelt)
dfEvapDiffMelt <- melt(dfEvapDiff[, c("TotalStorage","MinEvap","MaxEvap")], id = c("TotalStorage")) %>% arrange(TotalStorage)
ggplot() +
#Error bar
#geom_errorbar(data=dfCombineEvap, aes(x=CombLiveStor/1000000,ymin=EvapVolMaxLoComb/1000000, ymax=EvapVolMaxUpComb/1000000), width=.2,
#             position=position_dodge(0.2)) +
geom_line(data=dfPartitionResults,aes(x=TotalStorage,y=CombEvap/1000000, color = PercentInMead*100, group=PercentInMead), size=2) +
#Show the difference between the two
geom_text(data=dfEvapDiff, aes(x=TotalStorage,y=MaxEvap/1e6+0.1,label=round(Diff/1e6,2)), size=5, color="red") +
#verticle line to show difference
geom_line(data=dfEvapDiffMelt, aes(x=TotalStorage,y=variable, group=TotalStorage), size=1.5, color="red") +
#Label the top and bottom lines
geom_text(data=dfPartitionResults,aes(x=20,y=0.75,label="All in Mead"),size=6) +
geom_text(data=dfPartitionResults,aes(x=15,y=1.05,label="All in Powell"),size=6) +
geom_text(data=dfPartitionResults,aes(x=42.5,y=1.375,label="Difference between\nAll in Mead and\nAll in Powell\n(MAF per year)"),size=5, color="red") +
#geom_step(data=dfCutbacks,aes(x=2*MeadActiveVolume/1000000,y=Total2007ISG/1000000, color = "ISG", linetype="ISG"), size=2, direction="vh") +
#geom_step(data=dfCutbacks,aes(x=2*MeadActiveVolume/1000000,y=TotalDCP/1000000, color = "DCP", linetype="DCP"), size=2, direction="vh") +
#scale_color_manual(name="Guide1",values = c("Blue", "Black", "Red"),breaks=c("DCP", "ISG", "Evaporation"), labels= c("Drought Contingency Plan (2019) Cutbacks", "Interim Shortage Guidelines (2008) Cutbacks", paste("Evaporation",strEvapRangeComb))) +
#scale_linetype_manual(name="Guide1",values=c("Evaporation"="twodash","DCP"="solid","ISG"="longdash"), breaks=c("DCP", "ISG", "Evaporation"), labels= c("Drought Contingency Plan (2019) Cutbacks", "Interim Shortage Guidelines (2008) Cutbacks", paste("Evaporation",strEvapRangeComb))) +
#Continuous color scale by Mead Percent
scale_color_continuous(name="Storage in Mead (%)", low=palBlues[1],high=palBlues[9], na.value="White", aesthetics="color") +
#scale_color_continuous(low=palBlues[1],high=palBlues[9], na.value="White", aesthetics="color") +
scale_x_continuous(breaks = cCombScale,labels=cCombScale, limits = c(0,2*as.numeric(dfMaxStor %>% filter(Reservoir %in% c("Mead")) %>% select(Volume))),
sec.axis = sec_axis(~. +0, breaks = 2*dfMeadPoolsPlot$stor_maf, labels = dfMeadPoolsPlot$labelComb)) +
guides(color=guide_legend(keywidth = 3, keyheight = 1)) +
theme_bw() +
#coord_fixed() +
labs(x="Mead + Powell Active Storage (MAF)", y="Evaporated Volume (MAF per year)") +
theme(text = element_text(size=20), legend.text=element_text(size=18), legend.position = c(0.15,0.8))
ggplot() +
#Error bar
#geom_errorbar(data=dfCombineEvap, aes(x=CombLiveStor/1000000,ymin=EvapVolMaxLoComb/1000000, ymax=EvapVolMaxUpComb/1000000), width=.2,
#             position=position_dodge(0.2)) +
geom_line(data=dfPartitionResults,aes(x=TotalStorage,y=CombEvap/1000000, color = PercentInMead*100, group=PercentInMead), size=2) +
#Show the difference between the two
geom_text(data=dfEvapDiff, aes(x=TotalStorage,y=MaxEvap/1e6+0.1,label=round(Diff/1e6,2)), size=5, color="red") +
#verticle line to show difference
geom_line(data=dfEvapDiffMelt, aes(x=TotalStorage,y=value, group=TotalStorage), size=1.5, color="red") +
#Label the top and bottom lines
geom_text(data=dfPartitionResults,aes(x=20,y=0.75,label="All in Mead"),size=6) +
geom_text(data=dfPartitionResults,aes(x=15,y=1.05,label="All in Powell"),size=6) +
geom_text(data=dfPartitionResults,aes(x=42.5,y=1.375,label="Difference between\nAll in Mead and\nAll in Powell\n(MAF per year)"),size=5, color="red") +
#geom_step(data=dfCutbacks,aes(x=2*MeadActiveVolume/1000000,y=Total2007ISG/1000000, color = "ISG", linetype="ISG"), size=2, direction="vh") +
#geom_step(data=dfCutbacks,aes(x=2*MeadActiveVolume/1000000,y=TotalDCP/1000000, color = "DCP", linetype="DCP"), size=2, direction="vh") +
#scale_color_manual(name="Guide1",values = c("Blue", "Black", "Red"),breaks=c("DCP", "ISG", "Evaporation"), labels= c("Drought Contingency Plan (2019) Cutbacks", "Interim Shortage Guidelines (2008) Cutbacks", paste("Evaporation",strEvapRangeComb))) +
#scale_linetype_manual(name="Guide1",values=c("Evaporation"="twodash","DCP"="solid","ISG"="longdash"), breaks=c("DCP", "ISG", "Evaporation"), labels= c("Drought Contingency Plan (2019) Cutbacks", "Interim Shortage Guidelines (2008) Cutbacks", paste("Evaporation",strEvapRangeComb))) +
#Continuous color scale by Mead Percent
scale_color_continuous(name="Storage in Mead (%)", low=palBlues[1],high=palBlues[9], na.value="White", aesthetics="color") +
#scale_color_continuous(low=palBlues[1],high=palBlues[9], na.value="White", aesthetics="color") +
scale_x_continuous(breaks = cCombScale,labels=cCombScale, limits = c(0,2*as.numeric(dfMaxStor %>% filter(Reservoir %in% c("Mead")) %>% select(Volume))),
sec.axis = sec_axis(~. +0, breaks = 2*dfMeadPoolsPlot$stor_maf, labels = dfMeadPoolsPlot$labelComb)) +
guides(color=guide_legend(keywidth = 3, keyheight = 1)) +
theme_bw() +
#coord_fixed() +
labs(x="Mead + Powell Active Storage (MAF)", y="Evaporated Volume (MAF per year)") +
theme(text = element_text(size=20), legend.text=element_text(size=18), legend.position = c(0.15,0.8))
ggplot() +
#Error bar
#geom_errorbar(data=dfCombineEvap, aes(x=CombLiveStor/1000000,ymin=EvapVolMaxLoComb/1000000, ymax=EvapVolMaxUpComb/1000000), width=.2,
#             position=position_dodge(0.2)) +
geom_line(data=dfPartitionResults,aes(x=TotalStorage,y=CombEvap/1000000, color = PercentInMead*100, group=PercentInMead), size=2) +
#Show the difference between the two
geom_text(data=dfEvapDiff, aes(x=TotalStorage,y=MaxEvap/1e6+0.1,label=round(Diff/1e6,2)), size=5, color="red") +
#verticle line to show difference
geom_line(data=dfEvapDiffMelt, aes(x=TotalStorage,y=value/1e6, group=TotalStorage), size=1.5, color="red") +
#Label the top and bottom lines
geom_text(data=dfPartitionResults,aes(x=20,y=0.75,label="All in Mead"),size=6) +
geom_text(data=dfPartitionResults,aes(x=15,y=1.05,label="All in Powell"),size=6) +
geom_text(data=dfPartitionResults,aes(x=42.5,y=1.375,label="Difference between\nAll in Mead and\nAll in Powell\n(MAF per year)"),size=5, color="red") +
#geom_step(data=dfCutbacks,aes(x=2*MeadActiveVolume/1000000,y=Total2007ISG/1000000, color = "ISG", linetype="ISG"), size=2, direction="vh") +
#geom_step(data=dfCutbacks,aes(x=2*MeadActiveVolume/1000000,y=TotalDCP/1000000, color = "DCP", linetype="DCP"), size=2, direction="vh") +
#scale_color_manual(name="Guide1",values = c("Blue", "Black", "Red"),breaks=c("DCP", "ISG", "Evaporation"), labels= c("Drought Contingency Plan (2019) Cutbacks", "Interim Shortage Guidelines (2008) Cutbacks", paste("Evaporation",strEvapRangeComb))) +
#scale_linetype_manual(name="Guide1",values=c("Evaporation"="twodash","DCP"="solid","ISG"="longdash"), breaks=c("DCP", "ISG", "Evaporation"), labels= c("Drought Contingency Plan (2019) Cutbacks", "Interim Shortage Guidelines (2008) Cutbacks", paste("Evaporation",strEvapRangeComb))) +
#Continuous color scale by Mead Percent
scale_color_continuous(name="Storage in Mead (%)", low=palBlues[1],high=palBlues[9], na.value="White", aesthetics="color") +
#scale_color_continuous(low=palBlues[1],high=palBlues[9], na.value="White", aesthetics="color") +
scale_x_continuous(breaks = cCombScale,labels=cCombScale, limits = c(0,2*as.numeric(dfMaxStor %>% filter(Reservoir %in% c("Mead")) %>% select(Volume))),
sec.axis = sec_axis(~. +0, breaks = 2*dfMeadPoolsPlot$stor_maf, labels = dfMeadPoolsPlot$labelComb)) +
guides(color=guide_legend(keywidth = 3, keyheight = 1)) +
theme_bw() +
#coord_fixed() +
labs(x="Mead + Powell Active Storage (MAF)", y="Evaporated Volume (MAF per year)") +
theme(text = element_text(size=20), legend.text=element_text(size=18), legend.position = c(0.15,0.8))
ggplot() +
#Error bar
geom_errorbar(data=dfCombineEvap, aes(x=CombLiveStor/1000000,ymin=EvapVolMaxLoComb/1000000, ymax=EvapVolMaxUpComb/1000000), width=.2,
position=position_dodge(0.2)) +
geom_line(data=dfPartitionResults,aes(x=TotalStorage,y=CombEvap/1000000, color = PercentInMead*100, group=PercentInMead), size=2) +
#Show the difference between the two
geom_text(data=dfEvapDiff, aes(x=TotalStorage,y=MaxEvap/1e6+0.1,label=round(Diff/1e6,2)), size=5, color="red") +
#verticle line to show difference
geom_line(data=dfEvapDiffMelt, aes(x=TotalStorage,y=value/1e6, group=TotalStorage), size=1.5, color="red") +
#Label the top and bottom lines
geom_text(data=dfPartitionResults,aes(x=20,y=0.75,label="All in Mead"),size=6) +
geom_text(data=dfPartitionResults,aes(x=15,y=1.05,label="All in Powell"),size=6) +
geom_text(data=dfPartitionResults,aes(x=42.5,y=1.375,label="Difference between\nAll in Mead and\nAll in Powell\n(MAF per year)"),size=5, color="red") +
#geom_step(data=dfCutbacks,aes(x=2*MeadActiveVolume/1000000,y=Total2007ISG/1000000, color = "ISG", linetype="ISG"), size=2, direction="vh") +
#geom_step(data=dfCutbacks,aes(x=2*MeadActiveVolume/1000000,y=TotalDCP/1000000, color = "DCP", linetype="DCP"), size=2, direction="vh") +
#scale_color_manual(name="Guide1",values = c("Blue", "Black", "Red"),breaks=c("DCP", "ISG", "Evaporation"), labels= c("Drought Contingency Plan (2019) Cutbacks", "Interim Shortage Guidelines (2008) Cutbacks", paste("Evaporation",strEvapRangeComb))) +
#scale_linetype_manual(name="Guide1",values=c("Evaporation"="twodash","DCP"="solid","ISG"="longdash"), breaks=c("DCP", "ISG", "Evaporation"), labels= c("Drought Contingency Plan (2019) Cutbacks", "Interim Shortage Guidelines (2008) Cutbacks", paste("Evaporation",strEvapRangeComb))) +
#Continuous color scale by Mead Percent
scale_color_continuous(name="Storage in Mead (%)", low=palBlues[1],high=palBlues[9], na.value="White", aesthetics="color") +
#scale_color_continuous(low=palBlues[1],high=palBlues[9], na.value="White", aesthetics="color") +
scale_x_continuous(breaks = cCombScale,labels=cCombScale, limits = c(0,2*as.numeric(dfMaxStor %>% filter(Reservoir %in% c("Mead")) %>% select(Volume))),
sec.axis = sec_axis(~. +0, breaks = 2*dfMeadPoolsPlot$stor_maf, labels = dfMeadPoolsPlot$labelComb)) +
guides(color=guide_legend(keywidth = 3, keyheight = 1)) +
theme_bw() +
#coord_fixed() +
labs(x="Mead + Powell Active Storage (MAF)", y="Evaporated Volume (MAF per year)") +
theme(text = element_text(size=20), legend.text=element_text(size=18), legend.position = c(0.15,0.8))
View(dfCombineEvap)
View(dfCombineEvap)
ggplot() +
#Error bar
geom_errorbar(data=dfCombineEvap, aes(x=CombLiveStor/1000000,ymin=EvapVolMaxLoComb/1000000, ymax=EvapVolMaxUpComb/1000000), width=.2,
position=position_dodge(0.2)) +
geom_line(data=dfPartitionResults,aes(x=TotalStorage,y=CombEvap/1000000, color = PercentInMead*100, group=PercentInMead), size=2) +
#Show the difference between the two
geom_text(data=dfEvapDiff, aes(x=TotalStorage,y=MaxEvap/1e6+0.125,label=round(Diff/1e6,2)), size=5, color="red") +
#verticle line to show difference
geom_line(data=dfEvapDiffMelt, aes(x=TotalStorage,y=value/1e6, group=TotalStorage), size=1.5, color="red") +
#Label the top and bottom lines
geom_text(data=dfPartitionResults,aes(x=20,y=0.75,label="All in Mead"),size=6) +
geom_text(data=dfPartitionResults,aes(x=15,y=1.05,label="All in Powell"),size=6) +
geom_text(data=dfPartitionResults,aes(x=32.5,y=1.75,label="Difference between\nAll in Mead and\nAll in Powell\n(MAF per year)"),size=5, color="red") +
geom_text(data=dfPartitionResults,aes(x=42.5,y=1.25,label="Error on\nEvaporation Estimate"),size=5, color="black") +
#geom_step(data=dfCutbacks,aes(x=2*MeadActiveVolume/1000000,y=Total2007ISG/1000000, color = "ISG", linetype="ISG"), size=2, direction="vh") +
#geom_step(data=dfCutbacks,aes(x=2*MeadActiveVolume/1000000,y=TotalDCP/1000000, color = "DCP", linetype="DCP"), size=2, direction="vh") +
#scale_color_manual(name="Guide1",values = c("Blue", "Black", "Red"),breaks=c("DCP", "ISG", "Evaporation"), labels= c("Drought Contingency Plan (2019) Cutbacks", "Interim Shortage Guidelines (2008) Cutbacks", paste("Evaporation",strEvapRangeComb))) +
#scale_linetype_manual(name="Guide1",values=c("Evaporation"="twodash","DCP"="solid","ISG"="longdash"), breaks=c("DCP", "ISG", "Evaporation"), labels= c("Drought Contingency Plan (2019) Cutbacks", "Interim Shortage Guidelines (2008) Cutbacks", paste("Evaporation",strEvapRangeComb))) +
#Continuous color scale by Mead Percent
scale_color_continuous(name="Storage in Mead (%)", low=palBlues[1],high=palBlues[9], na.value="White", aesthetics="color") +
#scale_color_continuous(low=palBlues[1],high=palBlues[9], na.value="White", aesthetics="color") +
scale_x_continuous(breaks = cCombScale,labels=cCombScale, limits = c(0,2*as.numeric(dfMaxStor %>% filter(Reservoir %in% c("Mead")) %>% select(Volume))),
sec.axis = sec_axis(~. +0, breaks = 2*dfMeadPoolsPlot$stor_maf, labels = dfMeadPoolsPlot$labelComb)) +
guides(color=guide_legend(keywidth = 3, keyheight = 1)) +
theme_bw() +
#coord_fixed() +
labs(x="Mead + Powell Active Storage (MAF)", y="Evaporated Volume (MAF per year)") +
theme(text = element_text(size=20), legend.text=element_text(size=18), legend.position = c(0.15,0.8))
ggplot() +
#Error bar
geom_errorbar(data=dfCombineEvap, aes(x=CombLiveStor/1000000,ymin=EvapVolMaxLoComb/1000000, ymax=EvapVolMaxUpComb/1000000), width=.2,
position=position_dodge(0.2)) +
geom_line(data=dfPartitionResults,aes(x=TotalStorage,y=CombEvap/1000000, color = PercentInMead*100, group=PercentInMead), size=2) +
#Show the difference between the two
geom_text(data=dfEvapDiff, aes(x=TotalStorage,y=MaxEvap/1e6+0.125,label=round(Diff/1e6,2)), size=5, color="red") +
#verticle line to show difference
geom_line(data=dfEvapDiffMelt, aes(x=TotalStorage,y=value/1e6, group=TotalStorage), size=1.5, color="red") +
#Label the top and bottom lines
geom_text(data=dfPartitionResults,aes(x=20,y=0.75,label="All in Mead"),size=6, color=palBlues[9]) +
geom_text(data=dfPartitionResults,aes(x=15,y=1.05,label="All in Powell"),size=6, color=palBlues[9]) +
geom_text(data=dfPartitionResults,aes(x=32.5,y=1.75,label="Difference between\nAll in Mead and All in Powell\n(MAF per year)"),size=5, color="red") +
geom_text(data=dfPartitionResults,aes(x=42.5,y=1.25,label="Error on\nEvaporation Estimate"),size=5, color="black") +
#geom_step(data=dfCutbacks,aes(x=2*MeadActiveVolume/1000000,y=Total2007ISG/1000000, color = "ISG", linetype="ISG"), size=2, direction="vh") +
#geom_step(data=dfCutbacks,aes(x=2*MeadActiveVolume/1000000,y=TotalDCP/1000000, color = "DCP", linetype="DCP"), size=2, direction="vh") +
#scale_color_manual(name="Guide1",values = c("Blue", "Black", "Red"),breaks=c("DCP", "ISG", "Evaporation"), labels= c("Drought Contingency Plan (2019) Cutbacks", "Interim Shortage Guidelines (2008) Cutbacks", paste("Evaporation",strEvapRangeComb))) +
#scale_linetype_manual(name="Guide1",values=c("Evaporation"="twodash","DCP"="solid","ISG"="longdash"), breaks=c("DCP", "ISG", "Evaporation"), labels= c("Drought Contingency Plan (2019) Cutbacks", "Interim Shortage Guidelines (2008) Cutbacks", paste("Evaporation",strEvapRangeComb))) +
#Continuous color scale by Mead Percent
scale_color_continuous(name="Storage in Mead (%)", low=palBlues[1],high=palBlues[9], na.value="White", aesthetics="color") +
#scale_color_continuous(low=palBlues[1],high=palBlues[9], na.value="White", aesthetics="color") +
scale_x_continuous(breaks = cCombScale,labels=cCombScale, limits = c(0,2*as.numeric(dfMaxStor %>% filter(Reservoir %in% c("Mead")) %>% select(Volume))),
sec.axis = sec_axis(~. +0, breaks = 2*dfMeadPoolsPlot$stor_maf, labels = dfMeadPoolsPlot$labelComb)) +
guides(color=guide_legend(keywidth = 3, keyheight = 1)) +
theme_bw() +
#coord_fixed() +
labs(x="Mead + Powell Active Storage (MAF)", y="Evaporated Volume (MAF per year)") +
theme(text = element_text(size=20), legend.text=element_text(size=18), legend.position = c(0.15,0.8))
ggplot() +
#Error bar
geom_errorbar(data=dfCombineEvap, aes(x=CombLiveStor/1000000,ymin=EvapVolMaxLoComb/1000000, ymax=EvapVolMaxUpComb/1000000), width=.2,
position=position_dodge(0.2)) +
geom_line(data=dfPartitionResults,aes(x=TotalStorage,y=CombEvap/1000000, color = PercentInMead*100, group=PercentInMead), size=2) +
#Show the difference between the two
geom_text(data=dfEvapDiff, aes(x=TotalStorage,y=MaxEvap/1e6+0.13,label=round(Diff/1e6,2)), size=5, color="red") +
#verticle line to show difference
geom_line(data=dfEvapDiffMelt, aes(x=TotalStorage,y=value/1e6, group=TotalStorage), size=1.5, color="red") +
#Label the top and bottom lines
geom_text(data=dfPartitionResults,aes(x=20,y=0.75,label="All in Mead"),size=6, color=palBlues[9]) +
geom_text(data=dfPartitionResults,aes(x=15,y=1.05,label="All in Powell"),size=6, color=palBlues[9]) +
geom_text(data=dfPartitionResults,aes(x=32.5,y=1.85,label="Difference between\nAll in Mead and All in Powell\n(MAF per year)"),size=5, color="red") +
geom_text(data=dfPartitionResults,aes(x=42.5,y=1.3,label="Error on\nEvaporation Estimate"),size=5, color="black") +
#geom_step(data=dfCutbacks,aes(x=2*MeadActiveVolume/1000000,y=Total2007ISG/1000000, color = "ISG", linetype="ISG"), size=2, direction="vh") +
#geom_step(data=dfCutbacks,aes(x=2*MeadActiveVolume/1000000,y=TotalDCP/1000000, color = "DCP", linetype="DCP"), size=2, direction="vh") +
#scale_color_manual(name="Guide1",values = c("Blue", "Black", "Red"),breaks=c("DCP", "ISG", "Evaporation"), labels= c("Drought Contingency Plan (2019) Cutbacks", "Interim Shortage Guidelines (2008) Cutbacks", paste("Evaporation",strEvapRangeComb))) +
#scale_linetype_manual(name="Guide1",values=c("Evaporation"="twodash","DCP"="solid","ISG"="longdash"), breaks=c("DCP", "ISG", "Evaporation"), labels= c("Drought Contingency Plan (2019) Cutbacks", "Interim Shortage Guidelines (2008) Cutbacks", paste("Evaporation",strEvapRangeComb))) +
#Continuous color scale by Mead Percent
scale_color_continuous(name="Storage in Mead (%)", low=palBlues[1],high=palBlues[9], na.value="White", aesthetics="color") +
#scale_color_continuous(low=palBlues[1],high=palBlues[9], na.value="White", aesthetics="color") +
scale_x_continuous(breaks = cCombScale,labels=cCombScale, limits = c(0,2*as.numeric(dfMaxStor %>% filter(Reservoir %in% c("Mead")) %>% select(Volume))),
sec.axis = sec_axis(~. +0, breaks = 2*dfMeadPoolsPlot$stor_maf, labels = dfMeadPoolsPlot$labelComb)) +
guides(color=guide_legend(keywidth = 3, keyheight = 1)) +
theme_bw() +
#coord_fixed() +
labs(x="Mead + Powell Active Storage (MAF)", y="Evaporated Volume (MAF per year)") +
theme(text = element_text(size=20), legend.text=element_text(size=18), legend.position = c(0.15,0.8))
cPercentStorage <- cCombScale/(sum(dfMaxStor$Volume)/1e6)
View(dfMaxStor)
cPercentStorage <- cCombScale/(sum(dfMaxStor$Volume))
ggplot() +
#Error bar
geom_errorbar(data=dfCombineEvap, aes(x=CombLiveStor/1000000,ymin=EvapVolMaxLoComb/1000000, ymax=EvapVolMaxUpComb/1000000), width=.2,
position=position_dodge(0.2)) +
geom_line(data=dfPartitionResults,aes(x=TotalStorage,y=CombEvap/1000000, color = PercentInMead*100, group=PercentInMead), size=2) +
#Show the difference between the two
geom_text(data=dfEvapDiff, aes(x=TotalStorage,y=MaxEvap/1e6+0.13,label=round(Diff/1e6,2)), size=5, color="red") +
#verticle line to show difference
geom_line(data=dfEvapDiffMelt, aes(x=TotalStorage,y=value/1e6, group=TotalStorage), size=1.5, color="red") +
#Label the top and bottom lines
geom_text(data=dfPartitionResults,aes(x=20,y=0.75,label="All in Mead"),size=6, color=palBlues[9]) +
geom_text(data=dfPartitionResults,aes(x=15,y=1.05,label="All in Powell"),size=6, color=palBlues[9]) +
geom_text(data=dfPartitionResults,aes(x=32.5,y=1.85,label="Difference between\nAll in Mead and All in Powell\n(MAF per year)"),size=5, color="red") +
geom_text(data=dfPartitionResults,aes(x=42.5,y=1.3,label="Error on\nEvaporation Estimate"),size=5, color="black") +
#geom_step(data=dfCutbacks,aes(x=2*MeadActiveVolume/1000000,y=Total2007ISG/1000000, color = "ISG", linetype="ISG"), size=2, direction="vh") +
#geom_step(data=dfCutbacks,aes(x=2*MeadActiveVolume/1000000,y=TotalDCP/1000000, color = "DCP", linetype="DCP"), size=2, direction="vh") +
#scale_color_manual(name="Guide1",values = c("Blue", "Black", "Red"),breaks=c("DCP", "ISG", "Evaporation"), labels= c("Drought Contingency Plan (2019) Cutbacks", "Interim Shortage Guidelines (2008) Cutbacks", paste("Evaporation",strEvapRangeComb))) +
#scale_linetype_manual(name="Guide1",values=c("Evaporation"="twodash","DCP"="solid","ISG"="longdash"), breaks=c("DCP", "ISG", "Evaporation"), labels= c("Drought Contingency Plan (2019) Cutbacks", "Interim Shortage Guidelines (2008) Cutbacks", paste("Evaporation",strEvapRangeComb))) +
#Continuous color scale by Mead Percent
scale_color_continuous(name="Storage in Mead (%)", low=palBlues[1],high=palBlues[9], na.value="White", aesthetics="color") +
#scale_color_continuous(low=palBlues[1],high=palBlues[9], na.value="White", aesthetics="color") +
scale_x_continuous(breaks = cCombScale,labels=cCombScale, limits = c(0,2*as.numeric(dfMaxStor %>% filter(Reservoir %in% c("Mead")) %>% select(Volume))),
sec.axis = sec_axis(~ cCombScale/sum(dfMaxStor$Volume), breaks = seq(0,1,by=0.2), title="Fraction of Total Live Storage" )) +
guides(color=guide_legend(keywidth = 3, keyheight = 1)) +
theme_bw() +
#coord_fixed() +
labs(x="Mead + Powell Active Storage (MAF)", y="Evaporated Volume (MAF per year)") +
theme(text = element_text(size=20), legend.text=element_text(size=18), legend.position = c(0.15,0.8))
ggplot() +
#Error bar
geom_errorbar(data=dfCombineEvap, aes(x=CombLiveStor/1000000,ymin=EvapVolMaxLoComb/1000000, ymax=EvapVolMaxUpComb/1000000), width=.2,
position=position_dodge(0.2)) +
geom_line(data=dfPartitionResults,aes(x=TotalStorage,y=CombEvap/1000000, color = PercentInMead*100, group=PercentInMead), size=2) +
#Show the difference between the two
geom_text(data=dfEvapDiff, aes(x=TotalStorage,y=MaxEvap/1e6+0.13,label=round(Diff/1e6,2)), size=5, color="red") +
#verticle line to show difference
geom_line(data=dfEvapDiffMelt, aes(x=TotalStorage,y=value/1e6, group=TotalStorage), size=1.5, color="red") +
#Label the top and bottom lines
geom_text(data=dfPartitionResults,aes(x=20,y=0.75,label="All in Mead"),size=6, color=palBlues[9]) +
geom_text(data=dfPartitionResults,aes(x=15,y=1.05,label="All in Powell"),size=6, color=palBlues[9]) +
geom_text(data=dfPartitionResults,aes(x=32.5,y=1.85,label="Difference between\nAll in Mead and All in Powell\n(MAF per year)"),size=5, color="red") +
geom_text(data=dfPartitionResults,aes(x=42.5,y=1.3,label="Error on\nEvaporation Estimate"),size=5, color="black") +
#geom_step(data=dfCutbacks,aes(x=2*MeadActiveVolume/1000000,y=Total2007ISG/1000000, color = "ISG", linetype="ISG"), size=2, direction="vh") +
#geom_step(data=dfCutbacks,aes(x=2*MeadActiveVolume/1000000,y=TotalDCP/1000000, color = "DCP", linetype="DCP"), size=2, direction="vh") +
#scale_color_manual(name="Guide1",values = c("Blue", "Black", "Red"),breaks=c("DCP", "ISG", "Evaporation"), labels= c("Drought Contingency Plan (2019) Cutbacks", "Interim Shortage Guidelines (2008) Cutbacks", paste("Evaporation",strEvapRangeComb))) +
#scale_linetype_manual(name="Guide1",values=c("Evaporation"="twodash","DCP"="solid","ISG"="longdash"), breaks=c("DCP", "ISG", "Evaporation"), labels= c("Drought Contingency Plan (2019) Cutbacks", "Interim Shortage Guidelines (2008) Cutbacks", paste("Evaporation",strEvapRangeComb))) +
#Continuous color scale by Mead Percent
scale_color_continuous(name="Storage in Mead (%)", low=palBlues[1],high=palBlues[9], na.value="White", aesthetics="color") +
#scale_color_continuous(low=palBlues[1],high=palBlues[9], na.value="White", aesthetics="color") +
scale_x_continuous(breaks = cCombScale,labels=cCombScale, limits = c(0,2*as.numeric(dfMaxStor %>% filter(Reservoir %in% c("Mead")) %>% select(Volume))),
sec.axis = sec_axis(~ cCombScale/sum(dfMaxStor$Volume), breaks = seq(0,1,by=0.2), name="Fraction of Total Live Storage" )) +
guides(color=guide_legend(keywidth = 3, keyheight = 1)) +
theme_bw() +
#coord_fixed() +
labs(x="Mead + Powell Active Storage (MAF)", y="Evaporated Volume (MAF per year)") +
theme(text = element_text(size=20), legend.text=element_text(size=18), legend.position = c(0.15,0.8))
ggplot() +
#Error bar
geom_errorbar(data=dfCombineEvap, aes(x=CombLiveStor/1000000,ymin=EvapVolMaxLoComb/1000000, ymax=EvapVolMaxUpComb/1000000), width=.2,
position=position_dodge(0.2)) +
geom_line(data=dfPartitionResults,aes(x=TotalStorage,y=CombEvap/1000000, color = PercentInMead*100, group=PercentInMead), size=2) +
#Show the difference between the two
geom_text(data=dfEvapDiff, aes(x=TotalStorage,y=MaxEvap/1e6+0.13,label=round(Diff/1e6,2)), size=5, color="red") +
#verticle line to show difference
geom_line(data=dfEvapDiffMelt, aes(x=TotalStorage,y=value/1e6, group=TotalStorage), size=1.5, color="red") +
#Label the top and bottom lines
geom_text(data=dfPartitionResults,aes(x=20,y=0.75,label="All in Mead"),size=6, color=palBlues[9]) +
geom_text(data=dfPartitionResults,aes(x=15,y=1.05,label="All in Powell"),size=6, color=palBlues[9]) +
geom_text(data=dfPartitionResults,aes(x=32.5,y=1.85,label="Difference between\nAll in Mead and All in Powell\n(MAF per year)"),size=5, color="red") +
geom_text(data=dfPartitionResults,aes(x=42.5,y=1.3,label="Error on\nEvaporation Estimate"),size=5, color="black") +
#geom_step(data=dfCutbacks,aes(x=2*MeadActiveVolume/1000000,y=Total2007ISG/1000000, color = "ISG", linetype="ISG"), size=2, direction="vh") +
#geom_step(data=dfCutbacks,aes(x=2*MeadActiveVolume/1000000,y=TotalDCP/1000000, color = "DCP", linetype="DCP"), size=2, direction="vh") +
#scale_color_manual(name="Guide1",values = c("Blue", "Black", "Red"),breaks=c("DCP", "ISG", "Evaporation"), labels= c("Drought Contingency Plan (2019) Cutbacks", "Interim Shortage Guidelines (2008) Cutbacks", paste("Evaporation",strEvapRangeComb))) +
#scale_linetype_manual(name="Guide1",values=c("Evaporation"="twodash","DCP"="solid","ISG"="longdash"), breaks=c("DCP", "ISG", "Evaporation"), labels= c("Drought Contingency Plan (2019) Cutbacks", "Interim Shortage Guidelines (2008) Cutbacks", paste("Evaporation",strEvapRangeComb))) +
#Continuous color scale by Mead Percent
scale_color_continuous(name="Storage in Mead (%)", low=palBlues[1],high=palBlues[9], na.value="White", aesthetics="color") +
#scale_color_continuous(low=palBlues[1],high=palBlues[9], na.value="White", aesthetics="color") +
scale_x_continuous(breaks = cCombScale,labels=cCombScale, limits = c(0,2*as.numeric(dfMaxStor %>% filter(Reservoir %in% c("Mead")) %>% select(Volume))),
sec.axis = sec_axis(~ /sum(dfMaxStor$Volume), breaks = seq(0,1,by=0.2), name="Fraction of Total Active Storage" )) +
guides(color=guide_legend(keywidth = 3, keyheight = 1)) +
theme_bw() +
#coord_fixed() +
labs(x="Mead + Powell Active Storage (MAF)", y="Evaporated Volume (MAF per year)") +
theme(text = element_text(size=20), legend.text=element_text(size=18), legend.position = c(0.15,0.8))
ggplot() +
#Error bar
geom_errorbar(data=dfCombineEvap, aes(x=CombLiveStor/1000000,ymin=EvapVolMaxLoComb/1000000, ymax=EvapVolMaxUpComb/1000000), width=.2,
position=position_dodge(0.2)) +
geom_line(data=dfPartitionResults,aes(x=TotalStorage,y=CombEvap/1000000, color = PercentInMead*100, group=PercentInMead), size=2) +
#Show the difference between the two
geom_text(data=dfEvapDiff, aes(x=TotalStorage,y=MaxEvap/1e6+0.13,label=round(Diff/1e6,2)), size=5, color="red") +
#verticle line to show difference
geom_line(data=dfEvapDiffMelt, aes(x=TotalStorage,y=value/1e6, group=TotalStorage), size=1.5, color="red") +
#Label the top and bottom lines
geom_text(data=dfPartitionResults,aes(x=20,y=0.75,label="All in Mead"),size=6, color=palBlues[9]) +
geom_text(data=dfPartitionResults,aes(x=15,y=1.05,label="All in Powell"),size=6, color=palBlues[9]) +
geom_text(data=dfPartitionResults,aes(x=32.5,y=1.85,label="Difference between\nAll in Mead and All in Powell\n(MAF per year)"),size=5, color="red") +
geom_text(data=dfPartitionResults,aes(x=42.5,y=1.3,label="Error on\nEvaporation Estimate"),size=5, color="black") +
#geom_step(data=dfCutbacks,aes(x=2*MeadActiveVolume/1000000,y=Total2007ISG/1000000, color = "ISG", linetype="ISG"), size=2, direction="vh") +
#geom_step(data=dfCutbacks,aes(x=2*MeadActiveVolume/1000000,y=TotalDCP/1000000, color = "DCP", linetype="DCP"), size=2, direction="vh") +
#scale_color_manual(name="Guide1",values = c("Blue", "Black", "Red"),breaks=c("DCP", "ISG", "Evaporation"), labels= c("Drought Contingency Plan (2019) Cutbacks", "Interim Shortage Guidelines (2008) Cutbacks", paste("Evaporation",strEvapRangeComb))) +
#scale_linetype_manual(name="Guide1",values=c("Evaporation"="twodash","DCP"="solid","ISG"="longdash"), breaks=c("DCP", "ISG", "Evaporation"), labels= c("Drought Contingency Plan (2019) Cutbacks", "Interim Shortage Guidelines (2008) Cutbacks", paste("Evaporation",strEvapRangeComb))) +
#Continuous color scale by Mead Percent
scale_color_continuous(name="Storage in Mead (%)", low=palBlues[1],high=palBlues[9], na.value="White", aesthetics="color") +
#scale_color_continuous(low=palBlues[1],high=palBlues[9], na.value="White", aesthetics="color") +
scale_x_continuous(breaks = cCombScale,labels=cCombScale, limits = c(0,2*as.numeric(dfMaxStor %>% filter(Reservoir %in% c("Mead")) %>% select(Volume))),
sec.axis = sec_axis(~ 1/sum(dfMaxStor$Volume), breaks = seq(0,1,by=0.2), name="Fraction of Total Active Storage" )) +
guides(color=guide_legend(keywidth = 3, keyheight = 1)) +
theme_bw() +
#coord_fixed() +
labs(x="Mead + Powell Active Storage (MAF)", y="Evaporated Volume (MAF per year)") +
theme(text = element_text(size=20), legend.text=element_text(size=18), legend.position = c(0.15,0.8))
ggplot() +
#Error bar
geom_errorbar(data=dfCombineEvap, aes(x=CombLiveStor/1000000,ymin=EvapVolMaxLoComb/1000000, ymax=EvapVolMaxUpComb/1000000), width=.2,
position=position_dodge(0.2)) +
geom_line(data=dfPartitionResults,aes(x=TotalStorage,y=CombEvap/1000000, color = PercentInMead*100, group=PercentInMead), size=2) +
#Show the difference between the two
geom_text(data=dfEvapDiff, aes(x=TotalStorage,y=MaxEvap/1e6+0.13,label=round(Diff/1e6,2)), size=5, color="red") +
#verticle line to show difference
geom_line(data=dfEvapDiffMelt, aes(x=TotalStorage,y=value/1e6, group=TotalStorage), size=1.5, color="red") +
#Label the top and bottom lines
geom_text(data=dfPartitionResults,aes(x=20,y=0.75,label="All in Mead"),size=6, color=palBlues[9]) +
geom_text(data=dfPartitionResults,aes(x=15,y=1.05,label="All in Powell"),size=6, color=palBlues[9]) +
geom_text(data=dfPartitionResults,aes(x=32.5,y=1.85,label="Difference between\nAll in Mead and All in Powell\n(MAF per year)"),size=5, color="red") +
geom_text(data=dfPartitionResults,aes(x=42.5,y=1.3,label="Error on\nEvaporation Estimate"),size=5, color="black") +
#geom_step(data=dfCutbacks,aes(x=2*MeadActiveVolume/1000000,y=Total2007ISG/1000000, color = "ISG", linetype="ISG"), size=2, direction="vh") +
#geom_step(data=dfCutbacks,aes(x=2*MeadActiveVolume/1000000,y=TotalDCP/1000000, color = "DCP", linetype="DCP"), size=2, direction="vh") +
#scale_color_manual(name="Guide1",values = c("Blue", "Black", "Red"),breaks=c("DCP", "ISG", "Evaporation"), labels= c("Drought Contingency Plan (2019) Cutbacks", "Interim Shortage Guidelines (2008) Cutbacks", paste("Evaporation",strEvapRangeComb))) +
#scale_linetype_manual(name="Guide1",values=c("Evaporation"="twodash","DCP"="solid","ISG"="longdash"), breaks=c("DCP", "ISG", "Evaporation"), labels= c("Drought Contingency Plan (2019) Cutbacks", "Interim Shortage Guidelines (2008) Cutbacks", paste("Evaporation",strEvapRangeComb))) +
#Continuous color scale by Mead Percent
scale_color_continuous(name="Storage in Mead (%)", low=palBlues[1],high=palBlues[9], na.value="White", aesthetics="color") +
#scale_color_continuous(low=palBlues[1],high=palBlues[9], na.value="White", aesthetics="color") +
scale_x_continuous(breaks = cCombScale,labels=cCombScale, limits = c(0,2*as.numeric(dfMaxStor %>% filter(Reservoir %in% c("Mead")) %>% select(Volume))),
sec.axis = sec_axis(~.1/sum(dfMaxStor$Volume), breaks = seq(0,1,by=0.2), name="Fraction of Total Active Storage" )) +
guides(color=guide_legend(keywidth = 3, keyheight = 1)) +
theme_bw() +
#coord_fixed() +
labs(x="Mead + Powell Active Storage (MAF)", y="Evaporated Volume (MAF per year)") +
theme(text = element_text(size=20), legend.text=element_text(size=18), legend.position = c(0.15,0.8))
ggplot() +
#Error bar
geom_errorbar(data=dfCombineEvap, aes(x=CombLiveStor/1000000,ymin=EvapVolMaxLoComb/1000000, ymax=EvapVolMaxUpComb/1000000), width=.2,
position=position_dodge(0.2)) +
geom_line(data=dfPartitionResults,aes(x=TotalStorage,y=CombEvap/1000000, color = PercentInMead*100, group=PercentInMead), size=2) +
#Show the difference between the two
geom_text(data=dfEvapDiff, aes(x=TotalStorage,y=MaxEvap/1e6+0.13,label=round(Diff/1e6,2)), size=5, color="red") +
#verticle line to show difference
geom_line(data=dfEvapDiffMelt, aes(x=TotalStorage,y=value/1e6, group=TotalStorage), size=1.5, color="red") +
#Label the top and bottom lines
geom_text(data=dfPartitionResults,aes(x=20,y=0.75,label="All in Mead"),size=6, color=palBlues[9]) +
geom_text(data=dfPartitionResults,aes(x=15,y=1.05,label="All in Powell"),size=6, color=palBlues[9]) +
geom_text(data=dfPartitionResults,aes(x=32.5,y=1.85,label="Difference between\nAll in Mead and All in Powell\n(MAF per year)"),size=5, color="red") +
geom_text(data=dfPartitionResults,aes(x=42.5,y=1.3,label="Error on\nEvaporation Estimate"),size=5, color="black") +
#geom_step(data=dfCutbacks,aes(x=2*MeadActiveVolume/1000000,y=Total2007ISG/1000000, color = "ISG", linetype="ISG"), size=2, direction="vh") +
#geom_step(data=dfCutbacks,aes(x=2*MeadActiveVolume/1000000,y=TotalDCP/1000000, color = "DCP", linetype="DCP"), size=2, direction="vh") +
#scale_color_manual(name="Guide1",values = c("Blue", "Black", "Red"),breaks=c("DCP", "ISG", "Evaporation"), labels= c("Drought Contingency Plan (2019) Cutbacks", "Interim Shortage Guidelines (2008) Cutbacks", paste("Evaporation",strEvapRangeComb))) +
#scale_linetype_manual(name="Guide1",values=c("Evaporation"="twodash","DCP"="solid","ISG"="longdash"), breaks=c("DCP", "ISG", "Evaporation"), labels= c("Drought Contingency Plan (2019) Cutbacks", "Interim Shortage Guidelines (2008) Cutbacks", paste("Evaporation",strEvapRangeComb))) +
#Continuous color scale by Mead Percent
scale_color_continuous(name="Storage in Mead (%)", low=palBlues[1],high=palBlues[9], na.value="White", aesthetics="color") +
#scale_color_continuous(low=palBlues[1],high=palBlues[9], na.value="White", aesthetics="color") +
scale_x_continuous(breaks = cCombScale,labels=cCombScale, limits = c(0,2*as.numeric(dfMaxStor %>% filter(Reservoir %in% c("Mead")) %>% select(Volume))),
sec.axis = sec_axis(~ . /sum(dfMaxStor$Volume), breaks = seq(0,1,by=0.2), name="Fraction of Total Active Storage" )) +
guides(color=guide_legend(keywidth = 3, keyheight = 1)) +
theme_bw() +
#coord_fixed() +
labs(x="Mead + Powell Active Storage (MAF)", y="Evaporated Volume (MAF per year)") +
theme(text = element_text(size=20), legend.text=element_text(size=18), legend.position = c(0.15,0.8))
ggplot() +
#Error bar
geom_errorbar(data=dfCombineEvap, aes(x=CombLiveStor/1000000,ymin=EvapVolMaxLoComb/1000000, ymax=EvapVolMaxUpComb/1000000), width=.2,
position=position_dodge(0.2)) +
geom_line(data=dfPartitionResults,aes(x=TotalStorage,y=CombEvap/1000000, color = PercentInMead*100, group=PercentInMead), size=2) +
#Show the difference between the two
geom_text(data=dfEvapDiff, aes(x=TotalStorage,y=MaxEvap/1e6+0.18,label=round(Diff/1e6,2)), size=5, color="red") +
#verticle line to show difference
geom_line(data=dfEvapDiffMelt, aes(x=TotalStorage,y=value/1e6, group=TotalStorage), size=1.5, color="red") +
#Label the top and bottom lines
geom_text(data=dfPartitionResults,aes(x=20,y=0.75,label="All in Mead"),size=6, color=palBlues[9]) +
geom_text(data=dfPartitionResults,aes(x=15,y=1.1,label="All in Powell"),size=6, color=palBlues[9]) +
geom_text(data=dfPartitionResults,aes(x=32.5,y=1.85,label="Difference between\nAll in Mead and All in Powell\n(MAF per year)"),size=5, color="red") +
geom_text(data=dfPartitionResults,aes(x=42.5,y=1.3,label="Error on\nEvapored Volume"),size=5, color="black") +
#geom_step(data=dfCutbacks,aes(x=2*MeadActiveVolume/1000000,y=Total2007ISG/1000000, color = "ISG", linetype="ISG"), size=2, direction="vh") +
#geom_step(data=dfCutbacks,aes(x=2*MeadActiveVolume/1000000,y=TotalDCP/1000000, color = "DCP", linetype="DCP"), size=2, direction="vh") +
#scale_color_manual(name="Guide1",values = c("Blue", "Black", "Red"),breaks=c("DCP", "ISG", "Evaporation"), labels= c("Drought Contingency Plan (2019) Cutbacks", "Interim Shortage Guidelines (2008) Cutbacks", paste("Evaporation",strEvapRangeComb))) +
#scale_linetype_manual(name="Guide1",values=c("Evaporation"="twodash","DCP"="solid","ISG"="longdash"), breaks=c("DCP", "ISG", "Evaporation"), labels= c("Drought Contingency Plan (2019) Cutbacks", "Interim Shortage Guidelines (2008) Cutbacks", paste("Evaporation",strEvapRangeComb))) +
#Continuous color scale by Mead Percent
scale_color_continuous(name="Storage in Mead (%)", low=palBlues[1],high=palBlues[9], na.value="White", aesthetics="color") +
#scale_color_continuous(low=palBlues[1],high=palBlues[9], na.value="White", aesthetics="color") +
scale_x_continuous(breaks = cCombScale,labels=cCombScale, limits = c(0,2*as.numeric(dfMaxStor %>% filter(Reservoir %in% c("Mead")) %>% select(Volume))),
sec.axis = sec_axis(~ . /sum(dfMaxStor$Volume), breaks = seq(0,1,by=0.2), name="Fraction of Total Active Storage" )) +
guides(color=guide_legend(keywidth = 3, keyheight = 1)) +
theme_bw() +
#coord_fixed() +
labs(x="Mead + Powell Active Storage (MAF)", y="Evaporated Volume (MAF per year)") +
theme(text = element_text(size=20), legend.text=element_text(size=18), legend.position = c(0.15,0.8))
ggplot() +
#Central lines of evap
#Mead
geom_line(data=dfMeadEvap,aes(x=`Live Storage (ac-ft)`/1000000,y=EvapVolMax/1000000, color = "Mead"), size=1) +
#Powell
geom_line(data=dfPowellEvap,aes(x=`Live Storage (ac-ft)`/1000000,y=EvapVolMax/1000000, color = "Powell"), size=1) +
#Error bars on evap
#Powell first because wider
geom_errorbar(data=dfPowellEvap, aes(x=`Live Storage (ac-ft)`/1000000,ymin=EvapVolMaxLo/1000000, ymax=EvapVolMaxUp/1000000), width=.2,
position=position_dodge(0.2), color="blue", show.legend = FALSE) +
#Mead
geom_errorbar(data=dfMeadEvap, aes(x=`Live Storage (ac-ft)`/1000000,ymin=EvapVolMaxLo/1000000, ymax=EvapVolMaxUp/1000000), width=.2,
position=position_dodge(0.2), color="red", show.legend = FALSE) +
scale_color_manual(name="Guide1",values = c("red", "blue"), breaks=c("Mead", "Powell"), labels= c(paste("Mead",strEvapRangeMead), paste("Powell",strEvapRangePowell))) +
#scale_linetype_manual(name="Guide1",values=c("Mead"="twodash","Powell"="solid"), breaks=c("Mead","Powell"), labels= c(paste("Mead",strEvapRangeMead), paste("Powell",strEvapRangePowell))) +
#scale_color_manual(values = c("Blue", "Black", "Red", "Grey"), breaks=c("DCP", "ISG", "Mead", "Powell"), labels= c("Drought Contingency Plan (2019) Cutbacks", "Interim Shortage Guidelines (2008) Cutbacks", paste("Mead",strEvapRangMead))) +
#scale_linetype_manual("Variabler",values=c("Evaporation"="twodash","DCP"="solid","ISG"="longdash"),labels= c("Drought Contingency Plan (2019) Cutbacks", "Interim Shortage Guidelines (2008) Cutbacks", paste("Evaporation",strEvapRangeComb))) +
scale_x_continuous(breaks = c(0,5,10,15,20,25),labels=c(0,5,10,15, 20,25), limits = c(0,as.numeric(dfMaxStor %>% filter(Reservoir %in% c("Mead")) %>% select(Volume))),
sec.axis = sec_axis(~. +0, name = "", breaks = dfPoolsUse$stor_maf, labels = dfPoolsUse$LabelBr)) +
guides(fill = guide_legend(keywidth = 1, keyheight = 1),
#linetype=guide_legend(keywidth = 3, keyheight = 1),
colour=guide_legend(keywidth = 3, keyheight = 1)) +
theme_bw() +
#coord_fixed() +
labs(x="Active Storage (MAF)", y="Evaporated Volume\n(MAF per year)") +
theme(text = element_text(size=20),  legend.title = element_blank(), legend.text=element_text(size=18), legend.position = c(0.3,0.7),
#Box around legend
panel.border = element_rect(colour = "black", fill=NA),
#aspect.ratio = 1, axis.text = element_text(colour = 1, size = 12),
legend.background = element_rect(linetype = 1, size = 1, colour = 1))
ggplot() +
#Central lines of evap
#Mead
geom_line(data=dfMeadEvap,aes(x=`Live Storage (ac-ft)`/1000000,y=EvapVolMax/`Total Storage (ac-ft)`*100, color = "Mead"), size=1) +
#Powell
geom_line(data=dfPowellEvap,aes(x=`Live Storage (ac-ft)`/1000000,y=EvapVolMax/`Total Storage (ac-ft)`*100, color = "Powell"), size=1) +
# ICS Initial Assessment
geom_line(data=dfPowellEvap,aes(x=`Live Storage (ac-ft)`/1000000,y=5, color = "ICS-1st Year"), size=1) +
# ICS Subsequent Assessment
geom_line(data=dfPowellEvap,aes(x=`Live Storage (ac-ft)`/1000000,y=3, color = "ICS-Subsequent Years"), size=1) +
#Error bars on evap
#Powell first because wider
geom_errorbar(data=dfPowellEvap, aes(x=`Live Storage (ac-ft)`/1000000,ymin=EvapVolMaxLo/`Total Storage (ac-ft)`*100, ymax=EvapVolMaxUp/`Total Storage (ac-ft)`*100), width=.2,
position=position_dodge(0.2), color="blue", show.legend = FALSE) +
#Mead
geom_errorbar(data=dfMeadEvap, aes(x=`Live Storage (ac-ft)`/1000000,ymin=EvapVolMaxLo/`Total Storage (ac-ft)`*100, ymax=EvapVolMaxUp/`Total Storage (ac-ft)`*100), width=.2,
position=position_dodge(0.2), color="red", show.legend = FALSE) +
geom_text(data = dfEvapTraceLabels, aes(x=ActiveStorage,y=evaprate,label=label, color=color), size = 8) +
scale_color_manual(name="Guide1",values = c("black","blue","black", "black","black","black", "red"), breaks=c("Mead", "Powell","ICS-Year 1 (5%)", "ICS\nSubsequent Years (3%)")) +
#scale_linetype_manual(name="Guide1",values=c("Mead"="twodash","Powell"="solid"), breaks=c("Mead","Powell"), labels= c(paste("Mead",strEvapRangeMead), paste("Powell",strEvapRangePowell))) +
#scale_color_manual(values = c("Blue", "Black", "Red", "Grey"), breaks=c("DCP", "ISG", "Mead", "Powell"), labels= c("Drought Contingency Plan (2019) Cutbacks", "Interim Shortage Guidelines (2008) Cutbacks", paste("Mead",strEvapRangMead))) +
#scale_linetype_manual("Variabler",values=c("Evaporation"="twodash","DCP"="solid","ISG"="longdash"),labels= c("Drought Contingency Plan (2019) Cutbacks", "Interim Shortage Guidelines (2008) Cutbacks", paste("Evaporation",strEvapRangeComb))) +
scale_x_continuous(breaks = c(0,5,10,15,20,25),labels=c(0,5,10,15, 20,25), limits = c(0,as.numeric(dfMaxStor %>% filter(Reservoir %in% c("Mead")) %>% select(Volume))),
sec.axis = sec_axis(~. +0, name = "", breaks = dfPoolsUse$stor_maf, labels = dfPoolsUse$LabelBr)) +
guides(fill = guide_legend(keywidth = 1, keyheight = 1),
#linetype=guide_legend(keywidth = 3, keyheight = 1),
color = FALSE) +
#colour=guide_legend(keywidth = 3, keyheight = 1)) +
#xlim(1,27.5) +
theme_bw() +
#coord_fixed() +
labs(x="Active Storage (MAF)", y="Evaporated Volume per Year\n(% of Total Storage)") +
theme(text = element_text(size=20),  legend.title = element_blank(), legend.text=element_text(size=18), legend.position = c(0.3,0.7),
#Box around legend
panel.border = element_rect(colour = "black", fill=NA),
#aspect.ratio = 1, axis.text = element_text(colour = 1, size = 12),
legend.background = element_rect(linetype = 1, size = 1, colour = 1))
